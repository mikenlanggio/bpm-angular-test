{"ast":null,"code":"import { translate } from '../../util/SvgTransformUtil';\nimport { getVisual } from '../../util/GraphicsUtil';\nimport { append as svgAppend, attr as svgAttr, create as svgCreate, remove as svgRemove } from 'tiny-svg';\nvar LOW_PRIORITY = 750;\nexport default function CreatePreview(canvas, eventBus, graphicsFactory, previewSupport, styles) {\n  function createDragGroup(elements) {\n    var dragGroup = svgCreate('g');\n    svgAttr(dragGroup, styles.cls('djs-drag-group', ['no-events']));\n    var childrenGfx = svgCreate('g');\n    elements.forEach(function (element) {\n      // create graphics\n      var gfx;\n\n      if (element.hidden) {\n        return;\n      }\n\n      if (element.waypoints) {\n        gfx = graphicsFactory._createContainer('connection', childrenGfx);\n        graphicsFactory.drawConnection(getVisual(gfx), element);\n      } else {\n        gfx = graphicsFactory._createContainer('shape', childrenGfx);\n        graphicsFactory.drawShape(getVisual(gfx), element);\n        translate(gfx, element.x, element.y);\n      } // add preview\n\n\n      previewSupport.addDragger(element, dragGroup, gfx);\n    });\n    return dragGroup;\n  }\n\n  eventBus.on('create.move', LOW_PRIORITY, function (event) {\n    var hover = event.hover,\n        context = event.context,\n        elements = context.elements,\n        dragGroup = context.dragGroup; // lazily create previews\n\n    if (!dragGroup) {\n      dragGroup = context.dragGroup = createDragGroup(elements);\n    }\n\n    var activeLayer;\n\n    if (hover) {\n      if (!dragGroup.parentNode) {\n        activeLayer = canvas.getActiveLayer();\n        svgAppend(activeLayer, dragGroup);\n      }\n\n      translate(dragGroup, event.x, event.y);\n    } else {\n      svgRemove(dragGroup);\n    }\n  });\n  eventBus.on('create.cleanup', function (event) {\n    var context = event.context,\n        dragGroup = context.dragGroup;\n\n    if (dragGroup) {\n      svgRemove(dragGroup);\n    }\n  });\n}\nCreatePreview.$inject = ['canvas', 'eventBus', 'graphicsFactory', 'previewSupport', 'styles'];","map":{"version":3,"names":["translate","getVisual","append","svgAppend","attr","svgAttr","create","svgCreate","remove","svgRemove","LOW_PRIORITY","CreatePreview","canvas","eventBus","graphicsFactory","previewSupport","styles","createDragGroup","elements","dragGroup","cls","childrenGfx","forEach","element","gfx","hidden","waypoints","_createContainer","drawConnection","drawShape","x","y","addDragger","on","event","hover","context","activeLayer","parentNode","getActiveLayer","$inject"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/diagram-js/lib/features/create/CreatePreview.js"],"sourcesContent":["import {\r\n  translate\r\n} from '../../util/SvgTransformUtil';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nvar LOW_PRIORITY = 750;\r\n\r\n\r\nexport default function CreatePreview(\r\n    canvas,\r\n    eventBus,\r\n    graphicsFactory,\r\n    previewSupport,\r\n    styles\r\n) {\r\n  function createDragGroup(elements) {\r\n    var dragGroup = svgCreate('g');\r\n\r\n    svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\r\n\r\n    var childrenGfx = svgCreate('g');\r\n\r\n    elements.forEach(function(element) {\r\n\r\n      // create graphics\r\n      var gfx;\r\n\r\n      if (element.hidden) {\r\n        return;\r\n      }\r\n\r\n      if (element.waypoints) {\r\n        gfx = graphicsFactory._createContainer('connection', childrenGfx);\r\n\r\n        graphicsFactory.drawConnection(getVisual(gfx), element);\r\n      } else {\r\n        gfx = graphicsFactory._createContainer('shape', childrenGfx);\r\n\r\n        graphicsFactory.drawShape(getVisual(gfx), element);\r\n\r\n        translate(gfx, element.x, element.y);\r\n      }\r\n\r\n      // add preview\r\n      previewSupport.addDragger(element, dragGroup, gfx);\r\n    });\r\n\r\n    return dragGroup;\r\n  }\r\n\r\n  eventBus.on('create.move', LOW_PRIORITY, function(event) {\r\n\r\n    var hover = event.hover,\r\n        context = event.context,\r\n        elements = context.elements,\r\n        dragGroup = context.dragGroup;\r\n\r\n    // lazily create previews\r\n    if (!dragGroup) {\r\n      dragGroup = context.dragGroup = createDragGroup(elements);\r\n    }\r\n\r\n    var activeLayer;\r\n\r\n    if (hover) {\r\n      if (!dragGroup.parentNode) {\r\n        activeLayer = canvas.getActiveLayer();\r\n\r\n        svgAppend(activeLayer, dragGroup);\r\n      }\r\n\r\n      translate(dragGroup, event.x, event.y);\r\n    } else {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n\r\n  eventBus.on('create.cleanup', function(event) {\r\n    var context = event.context,\r\n        dragGroup = context.dragGroup;\r\n\r\n    if (dragGroup) {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n}\r\n\r\nCreatePreview.$inject = [\r\n  'canvas',\r\n  'eventBus',\r\n  'graphicsFactory',\r\n  'previewSupport',\r\n  'styles'\r\n];\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}