{"ast":null,"code":"import inherits from 'inherits-browser';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\nimport { is } from '../../../util/ModelUtil';\nimport { filter, forEach } from 'min-dash';\n/**\n * BPMN specific boundary event behavior\n */\n\nexport default function BoundaryEventBehavior(eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  function getBoundaryEvents(element) {\n    return filter(element.attachers, function (attacher) {\n      return is(attacher, 'bpmn:BoundaryEvent');\n    });\n  } // remove after connecting to event-based gateway\n\n\n  this.postExecute('connection.create', function (event) {\n    var source = event.context.source,\n        target = event.context.target,\n        boundaryEvents = getBoundaryEvents(target);\n\n    if (is(source, 'bpmn:EventBasedGateway') && is(target, 'bpmn:ReceiveTask') && boundaryEvents.length > 0) {\n      modeling.removeElements(boundaryEvents);\n    }\n  }); // remove after replacing connected gateway with event-based gateway\n\n  this.postExecute('connection.reconnect', function (event) {\n    var oldSource = event.context.oldSource,\n        newSource = event.context.newSource;\n\n    if (is(oldSource, 'bpmn:Gateway') && is(newSource, 'bpmn:EventBasedGateway')) {\n      forEach(newSource.outgoing, function (connection) {\n        var target = connection.target,\n            attachedboundaryEvents = getBoundaryEvents(target);\n\n        if (is(target, 'bpmn:ReceiveTask') && attachedboundaryEvents.length > 0) {\n          modeling.removeElements(attachedboundaryEvents);\n        }\n      });\n    }\n  });\n}\nBoundaryEventBehavior.$inject = ['eventBus', 'modeling'];\ninherits(BoundaryEventBehavior, CommandInterceptor);","map":{"version":3,"names":["inherits","CommandInterceptor","is","filter","forEach","BoundaryEventBehavior","eventBus","modeling","call","getBoundaryEvents","element","attachers","attacher","postExecute","event","source","context","target","boundaryEvents","length","removeElements","oldSource","newSource","outgoing","connection","attachedboundaryEvents","$inject"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/bpmn-js/lib/features/modeling/behavior/BoundaryEventBehavior.js"],"sourcesContent":["import inherits from 'inherits-browser';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  filter,\n  forEach\n} from 'min-dash';\n\n\n/**\n * BPMN specific boundary event behavior\n */\nexport default function BoundaryEventBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  function getBoundaryEvents(element) {\n    return filter(element.attachers, function(attacher) {\n      return is(attacher, 'bpmn:BoundaryEvent');\n    });\n  }\n\n  // remove after connecting to event-based gateway\n  this.postExecute('connection.create', function(event) {\n    var source = event.context.source,\n        target = event.context.target,\n        boundaryEvents = getBoundaryEvents(target);\n\n    if (\n      is(source, 'bpmn:EventBasedGateway') &&\n      is(target, 'bpmn:ReceiveTask') &&\n      boundaryEvents.length > 0\n    ) {\n      modeling.removeElements(boundaryEvents);\n    }\n\n  });\n\n  // remove after replacing connected gateway with event-based gateway\n  this.postExecute('connection.reconnect', function(event) {\n    var oldSource = event.context.oldSource,\n        newSource = event.context.newSource;\n\n    if (is(oldSource, 'bpmn:Gateway') &&\n        is(newSource, 'bpmn:EventBasedGateway')) {\n      forEach(newSource.outgoing, function(connection) {\n        var target = connection.target,\n            attachedboundaryEvents = getBoundaryEvents(target);\n\n        if (is(target, 'bpmn:ReceiveTask') &&\n            attachedboundaryEvents.length > 0) {\n          modeling.removeElements(attachedboundaryEvents);\n        }\n      });\n    }\n  });\n\n}\n\nBoundaryEventBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\ninherits(BoundaryEventBehavior, CommandInterceptor);"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,kBAArB;AAEA,OAAOC,kBAAP,MAA+B,2CAA/B;AAEA,SAASC,EAAT,QAAmB,yBAAnB;AAEA,SACEC,MADF,EAEEC,OAFF,QAGO,UAHP;AAMA;AACA;AACA;;AACA,eAAe,SAASC,qBAAT,CAA+BC,QAA/B,EAAyCC,QAAzC,EAAmD;EAEhEN,kBAAkB,CAACO,IAAnB,CAAwB,IAAxB,EAA8BF,QAA9B;;EAEA,SAASG,iBAAT,CAA2BC,OAA3B,EAAoC;IAClC,OAAOP,MAAM,CAACO,OAAO,CAACC,SAAT,EAAoB,UAASC,QAAT,EAAmB;MAClD,OAAOV,EAAE,CAACU,QAAD,EAAW,oBAAX,CAAT;IACD,CAFY,CAAb;EAGD,CAR+D,CAUhE;;;EACA,KAAKC,WAAL,CAAiB,mBAAjB,EAAsC,UAASC,KAAT,EAAgB;IACpD,IAAIC,MAAM,GAAGD,KAAK,CAACE,OAAN,CAAcD,MAA3B;IAAA,IACIE,MAAM,GAAGH,KAAK,CAACE,OAAN,CAAcC,MAD3B;IAAA,IAEIC,cAAc,GAAGT,iBAAiB,CAACQ,MAAD,CAFtC;;IAIA,IACEf,EAAE,CAACa,MAAD,EAAS,wBAAT,CAAF,IACAb,EAAE,CAACe,MAAD,EAAS,kBAAT,CADF,IAEAC,cAAc,CAACC,MAAf,GAAwB,CAH1B,EAIE;MACAZ,QAAQ,CAACa,cAAT,CAAwBF,cAAxB;IACD;EAEF,CAbD,EAXgE,CA0BhE;;EACA,KAAKL,WAAL,CAAiB,sBAAjB,EAAyC,UAASC,KAAT,EAAgB;IACvD,IAAIO,SAAS,GAAGP,KAAK,CAACE,OAAN,CAAcK,SAA9B;IAAA,IACIC,SAAS,GAAGR,KAAK,CAACE,OAAN,CAAcM,SAD9B;;IAGA,IAAIpB,EAAE,CAACmB,SAAD,EAAY,cAAZ,CAAF,IACAnB,EAAE,CAACoB,SAAD,EAAY,wBAAZ,CADN,EAC6C;MAC3ClB,OAAO,CAACkB,SAAS,CAACC,QAAX,EAAqB,UAASC,UAAT,EAAqB;QAC/C,IAAIP,MAAM,GAAGO,UAAU,CAACP,MAAxB;QAAA,IACIQ,sBAAsB,GAAGhB,iBAAiB,CAACQ,MAAD,CAD9C;;QAGA,IAAIf,EAAE,CAACe,MAAD,EAAS,kBAAT,CAAF,IACAQ,sBAAsB,CAACN,MAAvB,GAAgC,CADpC,EACuC;UACrCZ,QAAQ,CAACa,cAAT,CAAwBK,sBAAxB;QACD;MACF,CARM,CAAP;IASD;EACF,CAhBD;AAkBD;AAEDpB,qBAAqB,CAACqB,OAAtB,GAAgC,CAC9B,UAD8B,EAE9B,UAF8B,CAAhC;AAKA1B,QAAQ,CAACK,qBAAD,EAAwBJ,kBAAxB,CAAR"},"metadata":{},"sourceType":"module"}