{"ast":null,"code":"import { asTRBL, getMid } from '../../layout/LayoutUtil';\nimport { DEFAULT_DISTANCE } from './AutoPlaceUtil';\nvar LOW_PRIORITY = 100;\n/**\n * A service that places elements connected to existing ones\n * to an appropriate position in an _automated_ fashion.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\n\nexport default function AutoPlace(eventBus, modeling, canvas) {\n  eventBus.on('autoPlace', LOW_PRIORITY, function (context) {\n    var shape = context.shape,\n        source = context.source;\n    return getNewShapePosition(source, shape);\n  });\n  eventBus.on('autoPlace.end', function (event) {\n    canvas.scrollToElement(event.shape);\n  });\n  /**\n   * Append shape to source at appropriate position.\n   *\n   * @param {djs.model.Shape} source\n   * @param {djs.model.Shape} shape\n   *\n   * @return {djs.model.Shape} appended shape\n   */\n\n  this.append = function (source, shape, hints) {\n    eventBus.fire('autoPlace.start', {\n      source: source,\n      shape: shape\n    }); // allow others to provide the position\n\n    var position = eventBus.fire('autoPlace', {\n      source: source,\n      shape: shape\n    });\n    var newShape = modeling.appendShape(source, shape, position, source.parent, hints);\n    eventBus.fire('autoPlace.end', {\n      source: source,\n      shape: newShape\n    });\n    return newShape;\n  };\n}\nAutoPlace.$inject = ['eventBus', 'modeling', 'canvas']; // helpers //////////\n\n/**\n * Find the new position for the target element to\n * connect to source.\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n * @param  {Object} [hints]\n * @param  {Object} [hints.defaultDistance]\n *\n * @returns {Point}\n */\n\nfunction getNewShapePosition(source, element, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  var distance = hints.defaultDistance || DEFAULT_DISTANCE;\n  var sourceMid = getMid(source),\n      sourceTrbl = asTRBL(source); // simply put element right next to source\n\n  return {\n    x: sourceTrbl.right + distance + element.width / 2,\n    y: sourceMid.y\n  };\n}","map":{"version":3,"names":["asTRBL","getMid","DEFAULT_DISTANCE","LOW_PRIORITY","AutoPlace","eventBus","modeling","canvas","on","context","shape","source","getNewShapePosition","event","scrollToElement","append","hints","fire","position","newShape","appendShape","parent","$inject","element","distance","defaultDistance","sourceMid","sourceTrbl","x","right","width","y"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/diagram-js/lib/features/auto-place/AutoPlace.js"],"sourcesContent":["import {\n  asTRBL,\n  getMid\n} from '../../layout/LayoutUtil';\n\nimport { DEFAULT_DISTANCE } from './AutoPlaceUtil';\n\nvar LOW_PRIORITY = 100;\n\n\n/**\n * A service that places elements connected to existing ones\n * to an appropriate position in an _automated_ fashion.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AutoPlace(eventBus, modeling, canvas) {\n\n  eventBus.on('autoPlace', LOW_PRIORITY, function(context) {\n    var shape = context.shape,\n        source = context.source;\n\n    return getNewShapePosition(source, shape);\n  });\n\n  eventBus.on('autoPlace.end', function(event) {\n    canvas.scrollToElement(event.shape);\n  });\n\n  /**\n   * Append shape to source at appropriate position.\n   *\n   * @param {djs.model.Shape} source\n   * @param {djs.model.Shape} shape\n   *\n   * @return {djs.model.Shape} appended shape\n   */\n  this.append = function(source, shape, hints) {\n\n    eventBus.fire('autoPlace.start', {\n      source: source,\n      shape: shape\n    });\n\n    // allow others to provide the position\n    var position = eventBus.fire('autoPlace', {\n      source: source,\n      shape: shape\n    });\n\n    var newShape = modeling.appendShape(source, shape, position, source.parent, hints);\n\n    eventBus.fire('autoPlace.end', {\n      source: source,\n      shape: newShape\n    });\n\n    return newShape;\n  };\n\n}\n\nAutoPlace.$inject = [\n  'eventBus',\n  'modeling',\n  'canvas'\n];\n\n// helpers //////////\n\n/**\n * Find the new position for the target element to\n * connect to source.\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n * @param  {Object} [hints]\n * @param  {Object} [hints.defaultDistance]\n *\n * @returns {Point}\n */\nfunction getNewShapePosition(source, element, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  var distance = hints.defaultDistance || DEFAULT_DISTANCE;\n\n  var sourceMid = getMid(source),\n      sourceTrbl = asTRBL(source);\n\n  // simply put element right next to source\n  return {\n    x: sourceTrbl.right + distance + element.width / 2,\n    y: sourceMid.y\n  };\n}"],"mappings":"AAAA,SACEA,MADF,EAEEC,MAFF,QAGO,yBAHP;AAKA,SAASC,gBAAT,QAAiC,iBAAjC;AAEA,IAAIC,YAAY,GAAG,GAAnB;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,SAAT,CAAmBC,QAAnB,EAA6BC,QAA7B,EAAuCC,MAAvC,EAA+C;EAE5DF,QAAQ,CAACG,EAAT,CAAY,WAAZ,EAAyBL,YAAzB,EAAuC,UAASM,OAAT,EAAkB;IACvD,IAAIC,KAAK,GAAGD,OAAO,CAACC,KAApB;IAAA,IACIC,MAAM,GAAGF,OAAO,CAACE,MADrB;IAGA,OAAOC,mBAAmB,CAACD,MAAD,EAASD,KAAT,CAA1B;EACD,CALD;EAOAL,QAAQ,CAACG,EAAT,CAAY,eAAZ,EAA6B,UAASK,KAAT,EAAgB;IAC3CN,MAAM,CAACO,eAAP,CAAuBD,KAAK,CAACH,KAA7B;EACD,CAFD;EAIA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;EACE,KAAKK,MAAL,GAAc,UAASJ,MAAT,EAAiBD,KAAjB,EAAwBM,KAAxB,EAA+B;IAE3CX,QAAQ,CAACY,IAAT,CAAc,iBAAd,EAAiC;MAC/BN,MAAM,EAAEA,MADuB;MAE/BD,KAAK,EAAEA;IAFwB,CAAjC,EAF2C,CAO3C;;IACA,IAAIQ,QAAQ,GAAGb,QAAQ,CAACY,IAAT,CAAc,WAAd,EAA2B;MACxCN,MAAM,EAAEA,MADgC;MAExCD,KAAK,EAAEA;IAFiC,CAA3B,CAAf;IAKA,IAAIS,QAAQ,GAAGb,QAAQ,CAACc,WAAT,CAAqBT,MAArB,EAA6BD,KAA7B,EAAoCQ,QAApC,EAA8CP,MAAM,CAACU,MAArD,EAA6DL,KAA7D,CAAf;IAEAX,QAAQ,CAACY,IAAT,CAAc,eAAd,EAA+B;MAC7BN,MAAM,EAAEA,MADqB;MAE7BD,KAAK,EAAES;IAFsB,CAA/B;IAKA,OAAOA,QAAP;EACD,CArBD;AAuBD;AAEDf,SAAS,CAACkB,OAAV,GAAoB,CAClB,UADkB,EAElB,UAFkB,EAGlB,QAHkB,CAApB,C,CAMA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASV,mBAAT,CAA6BD,MAA7B,EAAqCY,OAArC,EAA8CP,KAA9C,EAAqD;EACnD,IAAI,CAACA,KAAL,EAAY;IACVA,KAAK,GAAG,EAAR;EACD;;EAED,IAAIQ,QAAQ,GAAGR,KAAK,CAACS,eAAN,IAAyBvB,gBAAxC;EAEA,IAAIwB,SAAS,GAAGzB,MAAM,CAACU,MAAD,CAAtB;EAAA,IACIgB,UAAU,GAAG3B,MAAM,CAACW,MAAD,CADvB,CAPmD,CAUnD;;EACA,OAAO;IACLiB,CAAC,EAAED,UAAU,CAACE,KAAX,GAAmBL,QAAnB,GAA8BD,OAAO,CAACO,KAAR,GAAgB,CAD5C;IAELC,CAAC,EAAEL,SAAS,CAACK;EAFR,CAAP;AAID"},"metadata":{},"sourceType":"module"}