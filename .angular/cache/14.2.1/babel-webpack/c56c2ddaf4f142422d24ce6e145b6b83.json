{"ast":null,"code":"import { assign } from 'min-dash';\nimport { getLabel } from './LabelUtil';\nimport { is } from '../../util/ModelUtil';\nimport { isAny } from '../modeling/util/ModelingUtil';\nimport { isExpanded } from '../../util/DiUtil';\nimport { getExternalLabelMid, isLabelExternal, hasExternalLabel, isLabel } from '../../util/LabelUtil';\nvar HIGH_PRIORITY = 2000;\nexport default function LabelEditingProvider(eventBus, bpmnFactory, canvas, directEditing, modeling, resizeHandles, textRenderer) {\n  this._bpmnFactory = bpmnFactory;\n  this._canvas = canvas;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n  directEditing.registerProvider(this); // listen to dblclick on non-root elements\n\n  eventBus.on('element.dblclick', function (event) {\n    activateDirectEdit(event.element, true);\n  }); // complete on followup canvas operation\n\n  eventBus.on(['autoPlace.start', 'canvas.viewbox.changing', 'drag.init', 'element.mousedown', 'popupMenu.open', 'root.set', 'selection.changed'], function (event) {\n    if (directEditing.isActive()) {\n      directEditing.complete();\n    }\n  });\n  eventBus.on(['shape.remove', 'connection.remove'], HIGH_PRIORITY, function (event) {\n    if (directEditing.isActive(event.element)) {\n      directEditing.cancel();\n    }\n  }); // cancel on command stack changes\n\n  eventBus.on(['commandStack.changed'], function (e) {\n    if (directEditing.isActive()) {\n      directEditing.cancel();\n    }\n  });\n  eventBus.on('directEditing.activate', function (event) {\n    resizeHandles.removeResizers();\n  });\n  eventBus.on('create.end', 500, function (event) {\n    var context = event.context,\n        element = context.shape,\n        canExecute = event.context.canExecute,\n        isTouch = event.isTouch; // TODO(nikku): we need to find a way to support the\n    // direct editing on mobile devices; right now this will\n    // break for desworkflowediting on mobile devices\n    // as it breaks the user interaction workflow\n    // TODO(nre): we should temporarily focus the edited element\n    // here and release the focused viewport after the direct edit\n    // operation is finished\n\n    if (isTouch) {\n      return;\n    }\n\n    if (!canExecute) {\n      return;\n    }\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    activateDirectEdit(element);\n  });\n  eventBus.on('autoPlace.end', 500, function (event) {\n    activateDirectEdit(event.shape);\n  });\n\n  function activateDirectEdit(element, force) {\n    if (force || isAny(element, ['bpmn:Task', 'bpmn:TextAnnotation']) || isCollapsedSubProcess(element)) {\n      directEditing.activate(element);\n    }\n  }\n}\nLabelEditingProvider.$inject = ['eventBus', 'bpmnFactory', 'canvas', 'directEditing', 'modeling', 'resizeHandles', 'textRenderer'];\n/**\n * Activate direct editing for activities and text annotations.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object with properties bounds (position and size), text and options\n */\n\nLabelEditingProvider.prototype.activate = function (element) {\n  // text\n  var text = getLabel(element);\n\n  if (text === undefined) {\n    return;\n  }\n\n  var context = {\n    text: text\n  }; // bounds\n\n  var bounds = this.getEditingBBox(element);\n  assign(context, bounds);\n  var options = {}; // tasks\n\n  if (isAny(element, ['bpmn:Task', 'bpmn:Participant', 'bpmn:Lane', 'bpmn:CallActivity']) || isCollapsedSubProcess(element)) {\n    assign(options, {\n      centerVertically: true\n    });\n  } // external labels\n\n\n  if (isLabelExternal(element)) {\n    assign(options, {\n      autoResize: true\n    });\n  } // text annotations\n\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(options, {\n      resizable: true,\n      autoResize: true\n    });\n  }\n\n  assign(context, {\n    options: options\n  });\n  return context;\n};\n/**\n * Get the editing bounding box based on the element's size and position\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object containing information about position\n *                  and size (fixed or minimum and/or maximum)\n */\n\n\nLabelEditingProvider.prototype.getEditingBBox = function (element) {\n  var canvas = this._canvas;\n  var target = element.label || element;\n  var bbox = canvas.getAbsoluteBBox(target);\n  var mid = {\n    x: bbox.x + bbox.width / 2,\n    y: bbox.y + bbox.height / 2\n  }; // default position\n\n  var bounds = {\n    x: bbox.x,\n    y: bbox.y\n  };\n  var zoom = canvas.zoom();\n\n  var defaultStyle = this._textRenderer.getDefaultStyle(),\n      externalStyle = this._textRenderer.getExternalStyle(); // take zoom into account\n\n\n  var externalFontSize = externalStyle.fontSize * zoom,\n      externalLineHeight = externalStyle.lineHeight,\n      defaultFontSize = defaultStyle.fontSize * zoom,\n      defaultLineHeight = defaultStyle.lineHeight;\n  var style = {\n    fontFamily: this._textRenderer.getDefaultStyle().fontFamily,\n    fontWeight: this._textRenderer.getDefaultStyle().fontWeight\n  }; // adjust for expanded pools AND lanes\n\n  if (is(element, 'bpmn:Lane') || isExpandedPool(element)) {\n    assign(bounds, {\n      width: bbox.height,\n      height: 30 * zoom,\n      x: bbox.x - bbox.height / 2 + 15 * zoom,\n      y: mid.y - 30 * zoom / 2\n    });\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: 7 * zoom + 'px',\n      paddingBottom: 7 * zoom + 'px',\n      paddingLeft: 5 * zoom + 'px',\n      paddingRight: 5 * zoom + 'px',\n      transform: 'rotate(-90deg)'\n    });\n  } // internal labels for tasks and collapsed call activities,\n  // sub processes and participants\n\n\n  if (isAny(element, ['bpmn:Task', 'bpmn:CallActivity']) || isCollapsedPool(element) || isCollapsedSubProcess(element)) {\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height\n    });\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: 7 * zoom + 'px',\n      paddingBottom: 7 * zoom + 'px',\n      paddingLeft: 5 * zoom + 'px',\n      paddingRight: 5 * zoom + 'px'\n    });\n  } // internal labels for expanded sub processes\n\n\n  if (isExpandedSubProcess(element)) {\n    assign(bounds, {\n      width: bbox.width,\n      x: bbox.x\n    });\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: 7 * zoom + 'px',\n      paddingBottom: 7 * zoom + 'px',\n      paddingLeft: 5 * zoom + 'px',\n      paddingRight: 5 * zoom + 'px'\n    });\n  }\n\n  var width = 90 * zoom,\n      paddingTop = 7 * zoom,\n      paddingBottom = 4 * zoom; // external labels for events, data elements, gateways, groups and connections\n\n  if (target.labelTarget) {\n    assign(bounds, {\n      width: width,\n      height: bbox.height + paddingTop + paddingBottom,\n      x: mid.x - width / 2,\n      y: bbox.y - paddingTop\n    });\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  } // external label not yet created\n\n\n  if (isLabelExternal(target) && !hasExternalLabel(target) && !isLabel(target)) {\n    var externalLabelMid = getExternalLabelMid(element);\n    var absoluteBBox = canvas.getAbsoluteBBox({\n      x: externalLabelMid.x,\n      y: externalLabelMid.y,\n      width: 0,\n      height: 0\n    });\n    var height = externalFontSize + paddingTop + paddingBottom;\n    assign(bounds, {\n      width: width,\n      height: height,\n      x: absoluteBBox.x - width / 2,\n      y: absoluteBBox.y - height / 2\n    });\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  } // text annotations\n\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height,\n      minWidth: 30 * zoom,\n      minHeight: 10 * zoom\n    });\n    assign(style, {\n      textAlign: 'left',\n      paddingTop: 5 * zoom + 'px',\n      paddingBottom: 7 * zoom + 'px',\n      paddingLeft: 7 * zoom + 'px',\n      paddingRight: 5 * zoom + 'px',\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight\n    });\n  }\n\n  return {\n    bounds: bounds,\n    style: style\n  };\n};\n\nLabelEditingProvider.prototype.update = function (element, newLabel, activeContextText, bounds) {\n  var newBounds, bbox;\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n    bbox = this._canvas.getAbsoluteBBox(element);\n    newBounds = {\n      x: element.x,\n      y: element.y,\n      width: element.width / bbox.width * bounds.width,\n      height: element.height / bbox.height * bounds.height\n    };\n  }\n\n  if (isEmptyText(newLabel)) {\n    newLabel = null;\n  }\n\n  this._modeling.updateLabel(element, newLabel, newBounds);\n}; // helpers //////////////////////\n\n\nfunction isCollapsedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && !isExpanded(element);\n}\n\nfunction isExpandedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && isExpanded(element);\n}\n\nfunction isCollapsedPool(element) {\n  return is(element, 'bpmn:Participant') && !isExpanded(element);\n}\n\nfunction isExpandedPool(element) {\n  return is(element, 'bpmn:Participant') && isExpanded(element);\n}\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","map":{"version":3,"names":["assign","getLabel","is","isAny","isExpanded","getExternalLabelMid","isLabelExternal","hasExternalLabel","isLabel","HIGH_PRIORITY","LabelEditingProvider","eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer","_bpmnFactory","_canvas","_modeling","_textRenderer","registerProvider","on","event","activateDirectEdit","element","isActive","complete","cancel","e","removeResizers","context","shape","canExecute","isTouch","hints","createElementsBehavior","force","isCollapsedSubProcess","activate","$inject","prototype","text","undefined","bounds","getEditingBBox","options","centerVertically","autoResize","resizable","target","label","bbox","getAbsoluteBBox","mid","x","width","y","height","zoom","defaultStyle","getDefaultStyle","externalStyle","getExternalStyle","externalFontSize","fontSize","externalLineHeight","lineHeight","defaultFontSize","defaultLineHeight","style","fontFamily","fontWeight","isExpandedPool","paddingTop","paddingBottom","paddingLeft","paddingRight","transform","isCollapsedPool","isExpandedSubProcess","labelTarget","externalLabelMid","absoluteBBox","minWidth","minHeight","textAlign","update","newLabel","activeContextText","newBounds","isEmptyText","updateLabel","trim"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/bpmn-js/lib/features/label-editing/LabelEditingProvider.js"],"sourcesContent":["import {\n  assign\n} from 'min-dash';\n\nimport {\n  getLabel\n} from './LabelUtil';\n\nimport {\n  is\n} from '../../util/ModelUtil';\n\nimport { isAny } from '../modeling/util/ModelingUtil';\nimport { isExpanded } from '../../util/DiUtil';\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from '../../util/LabelUtil';\n\nvar HIGH_PRIORITY = 2000;\n\n\nexport default function LabelEditingProvider(\n    eventBus, bpmnFactory, canvas, directEditing,\n    modeling, resizeHandles, textRenderer) {\n\n  this._bpmnFactory = bpmnFactory;\n  this._canvas = canvas;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n\n  directEditing.registerProvider(this);\n\n  // listen to dblclick on non-root elements\n  eventBus.on('element.dblclick', function(event) {\n    activateDirectEdit(event.element, true);\n  });\n\n  // complete on followup canvas operation\n  eventBus.on([\n    'autoPlace.start',\n    'canvas.viewbox.changing',\n    'drag.init',\n    'element.mousedown',\n    'popupMenu.open',\n    'root.set',\n    'selection.changed'\n  ], function(event) {\n\n    if (directEditing.isActive()) {\n      directEditing.complete();\n    }\n  });\n\n  eventBus.on([\n    'shape.remove',\n    'connection.remove'\n  ], HIGH_PRIORITY, function(event) {\n\n    if (directEditing.isActive(event.element)) {\n      directEditing.cancel();\n    }\n  });\n\n  // cancel on command stack changes\n  eventBus.on([ 'commandStack.changed' ], function(e) {\n    if (directEditing.isActive()) {\n      directEditing.cancel();\n    }\n  });\n\n\n  eventBus.on('directEditing.activate', function(event) {\n    resizeHandles.removeResizers();\n  });\n\n  eventBus.on('create.end', 500, function(event) {\n\n    var context = event.context,\n        element = context.shape,\n        canExecute = event.context.canExecute,\n        isTouch = event.isTouch;\n\n    // TODO(nikku): we need to find a way to support the\n    // direct editing on mobile devices; right now this will\n    // break for desworkflowediting on mobile devices\n    // as it breaks the user interaction workflow\n\n    // TODO(nre): we should temporarily focus the edited element\n    // here and release the focused viewport after the direct edit\n    // operation is finished\n    if (isTouch) {\n      return;\n    }\n\n    if (!canExecute) {\n      return;\n    }\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    activateDirectEdit(element);\n  });\n\n  eventBus.on('autoPlace.end', 500, function(event) {\n    activateDirectEdit(event.shape);\n  });\n\n\n  function activateDirectEdit(element, force) {\n    if (force ||\n        isAny(element, [ 'bpmn:Task', 'bpmn:TextAnnotation' ]) ||\n        isCollapsedSubProcess(element)) {\n\n      directEditing.activate(element);\n    }\n  }\n\n}\n\nLabelEditingProvider.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'canvas',\n  'directEditing',\n  'modeling',\n  'resizeHandles',\n  'textRenderer'\n];\n\n\n/**\n * Activate direct editing for activities and text annotations.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object with properties bounds (position and size), text and options\n */\nLabelEditingProvider.prototype.activate = function(element) {\n\n  // text\n  var text = getLabel(element);\n\n  if (text === undefined) {\n    return;\n  }\n\n  var context = {\n    text: text\n  };\n\n  // bounds\n  var bounds = this.getEditingBBox(element);\n\n  assign(context, bounds);\n\n  var options = {};\n\n  // tasks\n  if (\n    isAny(element, [\n      'bpmn:Task',\n      'bpmn:Participant',\n      'bpmn:Lane',\n      'bpmn:CallActivity'\n    ]) ||\n    isCollapsedSubProcess(element)\n  ) {\n    assign(options, {\n      centerVertically: true\n    });\n  }\n\n  // external labels\n  if (isLabelExternal(element)) {\n    assign(options, {\n      autoResize: true\n    });\n  }\n\n  // text annotations\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(options, {\n      resizable: true,\n      autoResize: true\n    });\n  }\n\n  assign(context, {\n    options: options\n  });\n\n  return context;\n};\n\n\n/**\n * Get the editing bounding box based on the element's size and position\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object containing information about position\n *                  and size (fixed or minimum and/or maximum)\n */\nLabelEditingProvider.prototype.getEditingBBox = function(element) {\n  var canvas = this._canvas;\n\n  var target = element.label || element;\n\n  var bbox = canvas.getAbsoluteBBox(target);\n\n  var mid = {\n    x: bbox.x + bbox.width / 2,\n    y: bbox.y + bbox.height / 2\n  };\n\n  // default position\n  var bounds = { x: bbox.x, y: bbox.y };\n\n  var zoom = canvas.zoom();\n\n  var defaultStyle = this._textRenderer.getDefaultStyle(),\n      externalStyle = this._textRenderer.getExternalStyle();\n\n  // take zoom into account\n  var externalFontSize = externalStyle.fontSize * zoom,\n      externalLineHeight = externalStyle.lineHeight,\n      defaultFontSize = defaultStyle.fontSize * zoom,\n      defaultLineHeight = defaultStyle.lineHeight;\n\n  var style = {\n    fontFamily: this._textRenderer.getDefaultStyle().fontFamily,\n    fontWeight: this._textRenderer.getDefaultStyle().fontWeight\n  };\n\n  // adjust for expanded pools AND lanes\n  if (is(element, 'bpmn:Lane') || isExpandedPool(element)) {\n\n    assign(bounds, {\n      width: bbox.height,\n      height: 30 * zoom,\n      x: bbox.x - bbox.height / 2 + (15 * zoom),\n      y: mid.y - (30 * zoom) / 2\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px',\n      transform: 'rotate(-90deg)'\n    });\n  }\n\n\n  // internal labels for tasks and collapsed call activities,\n  // sub processes and participants\n  if (isAny(element, [ 'bpmn:Task', 'bpmn:CallActivity' ]) ||\n      isCollapsedPool(element) ||\n      isCollapsedSubProcess(element)) {\n\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n\n  // internal labels for expanded sub processes\n  if (isExpandedSubProcess(element)) {\n    assign(bounds, {\n      width: bbox.width,\n      x: bbox.x\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n  var width = 90 * zoom,\n      paddingTop = 7 * zoom,\n      paddingBottom = 4 * zoom;\n\n  // external labels for events, data elements, gateways, groups and connections\n  if (target.labelTarget) {\n    assign(bounds, {\n      width: width,\n      height: bbox.height + paddingTop + paddingBottom,\n      x: mid.x - width / 2,\n      y: bbox.y - paddingTop\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // external label not yet created\n  if (isLabelExternal(target)\n      && !hasExternalLabel(target)\n      && !isLabel(target)) {\n\n    var externalLabelMid = getExternalLabelMid(element);\n\n    var absoluteBBox = canvas.getAbsoluteBBox({\n      x: externalLabelMid.x,\n      y: externalLabelMid.y,\n      width: 0,\n      height: 0\n    });\n\n    var height = externalFontSize + paddingTop + paddingBottom;\n\n    assign(bounds, {\n      width: width,\n      height: height,\n      x: absoluteBBox.x - width / 2,\n      y: absoluteBBox.y - height / 2\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // text annotations\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height,\n      minWidth: 30 * zoom,\n      minHeight: 10 * zoom\n    });\n\n    assign(style, {\n      textAlign: 'left',\n      paddingTop: (5 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (7 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px',\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight\n    });\n  }\n\n  return { bounds: bounds, style: style };\n};\n\n\nLabelEditingProvider.prototype.update = function(\n    element, newLabel,\n    activeContextText, bounds) {\n\n  var newBounds,\n      bbox;\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n\n    bbox = this._canvas.getAbsoluteBBox(element);\n\n    newBounds = {\n      x: element.x,\n      y: element.y,\n      width: element.width / bbox.width * bounds.width,\n      height: element.height / bbox.height * bounds.height\n    };\n  }\n\n  if (isEmptyText(newLabel)) {\n    newLabel = null;\n  }\n\n  this._modeling.updateLabel(element, newLabel, newBounds);\n};\n\n\n\n// helpers //////////////////////\n\nfunction isCollapsedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && !isExpanded(element);\n}\n\nfunction isExpandedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && isExpanded(element);\n}\n\nfunction isCollapsedPool(element) {\n  return is(element, 'bpmn:Participant') && !isExpanded(element);\n}\n\nfunction isExpandedPool(element) {\n  return is(element, 'bpmn:Participant') && isExpanded(element);\n}\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}