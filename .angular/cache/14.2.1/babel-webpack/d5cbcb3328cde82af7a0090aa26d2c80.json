{"ast":null,"code":"import inherits from 'inherits-browser';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\nimport { is } from '../../../util/ModelUtil';\nimport { getChildLanes } from '../util/LaneUtil';\nimport { eachElement } from 'diagram-js/lib/util/Elements';\nvar LOW_PRIORITY = 500;\n/**\n * BPMN specific delete lane behavior\n */\n\nexport default function DeleteLaneBehavior(eventBus, modeling, spaceTool) {\n  CommandInterceptor.call(this, eventBus);\n\n  function compensateLaneDelete(shape, oldParent) {\n    var siblings = getChildLanes(oldParent);\n    var topAffected = [];\n    var bottomAffected = [];\n    eachElement(siblings, function (element) {\n      if (element.y > shape.y) {\n        bottomAffected.push(element);\n      } else {\n        topAffected.push(element);\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    var offset;\n\n    if (bottomAffected.length && topAffected.length) {\n      offset = shape.height / 2;\n    } else {\n      offset = shape.height;\n    }\n\n    var topAdjustments, bottomAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(topAffected, 'y', offset, shape.y - 10);\n      spaceTool.makeSpace(topAdjustments.movingShapes, topAdjustments.resizingShapes, {\n        x: 0,\n        y: offset\n      }, 's');\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n      spaceTool.makeSpace(bottomAdjustments.movingShapes, bottomAdjustments.resizingShapes, {\n        x: 0,\n        y: -offset\n      }, 'n');\n    }\n  }\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n\n\n  this.postExecuted('shape.delete', LOW_PRIORITY, function (event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        oldParent = context.oldParent; // only compensate lane deletes\n\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    } // compensate root deletes only\n\n\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\nDeleteLaneBehavior.$inject = ['eventBus', 'modeling', 'spaceTool'];\ninherits(DeleteLaneBehavior, CommandInterceptor);","map":{"version":3,"names":["inherits","CommandInterceptor","is","getChildLanes","eachElement","LOW_PRIORITY","DeleteLaneBehavior","eventBus","modeling","spaceTool","call","compensateLaneDelete","shape","oldParent","siblings","topAffected","bottomAffected","element","y","push","children","length","offset","height","topAdjustments","bottomAdjustments","calculateAdjustments","makeSpace","movingShapes","resizingShapes","x","postExecuted","event","context","hints","nested","$inject"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/bpmn-js/lib/features/modeling/behavior/DeleteLaneBehavior.js"],"sourcesContent":["import inherits from 'inherits-browser';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  getChildLanes\n} from '../util/LaneUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function DeleteLaneBehavior(eventBus, modeling, spaceTool) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function compensateLaneDelete(shape, oldParent) {\n\n    var siblings = getChildLanes(oldParent);\n\n    var topAffected = [];\n    var bottomAffected = [];\n\n    eachElement(siblings, function(element) {\n\n      if (element.y > shape.y) {\n        bottomAffected.push(element);\n      } else {\n        topAffected.push(element);\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    var offset;\n\n    if (bottomAffected.length && topAffected.length) {\n      offset = shape.height / 2;\n    } else {\n      offset = shape.height;\n    }\n\n    var topAdjustments,\n        bottomAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(\n        topAffected, 'y', offset, shape.y - 10);\n\n      spaceTool.makeSpace(\n        topAdjustments.movingShapes,\n        topAdjustments.resizingShapes,\n        { x: 0, y: offset }, 's');\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(\n        bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n\n      spaceTool.makeSpace(\n        bottomAdjustments.movingShapes,\n        bottomAdjustments.resizingShapes,\n        { x: 0, y: -offset }, 'n');\n    }\n  }\n\n\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n  this.postExecuted('shape.delete', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        oldParent = context.oldParent;\n\n    // only compensate lane deletes\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    }\n\n    // compensate root deletes only\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\n\nDeleteLaneBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'spaceTool'\n];\n\ninherits(DeleteLaneBehavior, CommandInterceptor);"],"mappings":"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"},"metadata":{},"sourceType":"module"}