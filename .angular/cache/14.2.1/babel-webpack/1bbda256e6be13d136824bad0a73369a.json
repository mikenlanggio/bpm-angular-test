{"ast":null,"code":"import { getLanesRoot } from '../util/LaneUtil';\nimport { is } from '../../../util/ModelUtil';\nimport { isAny } from '../util/ModelingUtil';\nvar HIGH_PRIORITY = 1500;\nvar HIGHEST_PRIORITY = 2000;\n/**\r\n * Correct hover targets in certain situations to improve diagram interaction.\r\n *\r\n * @param {ElementRegistry} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n */\n\nexport default function FixHoverBehavior(elementRegistry, eventBus, canvas) {\n  eventBus.on(['create.hover', 'create.move', 'create.out', 'create.end', 'shape.move.hover', 'shape.move.move', 'shape.move.out', 'shape.move.end'], HIGH_PRIORITY, function (event) {\n    var context = event.context,\n        shape = context.shape || event.shape,\n        hover = event.hover; // ensure elements are not dropped onto a bpmn:Lane but onto\n    // the underlying bpmn:Participant\n\n    if (is(hover, 'bpmn:Lane') && !isAny(shape, ['bpmn:Lane', 'bpmn:Participant'])) {\n      event.hover = getLanesRoot(hover);\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n\n    var rootElement = canvas.getRootElement(); // ensure bpmn:Group and label elements are dropped\n    // always onto the root\n\n    if (hover !== rootElement && (shape.labelTarget || is(shape, 'bpmn:Group'))) {\n      event.hover = rootElement;\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n  });\n  eventBus.on(['connect.hover', 'connect.out', 'connect.end', 'connect.cleanup', 'global-connect.hover', 'global-connect.out', 'global-connect.end', 'global-connect.cleanup'], HIGH_PRIORITY, function (event) {\n    var hover = event.hover; // ensure connections start/end on bpmn:Participant,\n    // not the underlying bpmn:Lane\n\n    if (is(hover, 'bpmn:Lane')) {\n      event.hover = getLanesRoot(hover) || hover;\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n  });\n  eventBus.on(['bendpoint.move.hover'], HIGH_PRIORITY, function (event) {\n    var context = event.context,\n        hover = event.hover,\n        type = context.type; // ensure reconnect start/end on bpmn:Participant,\n    // not the underlying bpmn:Lane\n\n    if (is(hover, 'bpmn:Lane') && /reconnect/.test(type)) {\n      event.hover = getLanesRoot(hover) || hover;\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n  });\n  eventBus.on(['connect.start'], HIGH_PRIORITY, function (event) {\n    var context = event.context,\n        start = context.start; // ensure connect start on bpmn:Participant,\n    // not the underlying bpmn:Lane\n\n    if (is(start, 'bpmn:Lane')) {\n      context.start = getLanesRoot(start) || start;\n    }\n  }); // allow movement of participants from lanes\n\n  eventBus.on('shape.move.start', HIGHEST_PRIORITY, function (event) {\n    var shape = event.shape;\n\n    if (is(shape, 'bpmn:Lane')) {\n      event.shape = getLanesRoot(shape) || shape;\n    }\n  });\n}\nFixHoverBehavior.$inject = ['elementRegistry', 'eventBus', 'canvas'];","map":{"version":3,"names":["getLanesRoot","is","isAny","HIGH_PRIORITY","HIGHEST_PRIORITY","FixHoverBehavior","elementRegistry","eventBus","canvas","on","event","context","shape","hover","hoverGfx","getGraphics","rootElement","getRootElement","labelTarget","type","test","start","$inject"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/bpmn-js/lib/features/modeling/behavior/FixHoverBehavior.js"],"sourcesContent":["import { getLanesRoot } from '../util/LaneUtil';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nvar HIGH_PRIORITY = 1500;\r\nvar HIGHEST_PRIORITY = 2000;\r\n\r\n\r\n/**\r\n * Correct hover targets in certain situations to improve diagram interaction.\r\n *\r\n * @param {ElementRegistry} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n */\r\nexport default function FixHoverBehavior(elementRegistry, eventBus, canvas) {\r\n\r\n  eventBus.on([\r\n    'create.hover',\r\n    'create.move',\r\n    'create.out',\r\n    'create.end',\r\n    'shape.move.hover',\r\n    'shape.move.move',\r\n    'shape.move.out',\r\n    'shape.move.end'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape || event.shape,\r\n        hover = event.hover;\r\n\r\n    // ensure elements are not dropped onto a bpmn:Lane but onto\r\n    // the underlying bpmn:Participant\r\n    if (is(hover, 'bpmn:Lane') && !isAny(shape, [ 'bpmn:Lane', 'bpmn:Participant' ])) {\r\n      event.hover = getLanesRoot(hover);\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n\r\n    var rootElement = canvas.getRootElement();\r\n\r\n    // ensure bpmn:Group and label elements are dropped\r\n    // always onto the root\r\n    if (hover !== rootElement && (shape.labelTarget || is(shape, 'bpmn:Group'))) {\r\n      event.hover = rootElement;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.out',\r\n    'connect.end',\r\n    'connect.cleanup',\r\n    'global-connect.hover',\r\n    'global-connect.out',\r\n    'global-connect.end',\r\n    'global-connect.cleanup'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var hover = event.hover;\r\n\r\n    // ensure connections start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane')) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'bendpoint.move.hover'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        hover = event.hover,\r\n        type = context.type;\r\n\r\n    // ensure reconnect start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane') && /reconnect/.test(type)) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'connect.start'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        start = context.start;\r\n\r\n    // ensure connect start on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(start, 'bpmn:Lane')) {\r\n      context.start = getLanesRoot(start) || start;\r\n    }\r\n  });\r\n\r\n\r\n  // allow movement of participants from lanes\r\n  eventBus.on('shape.move.start', HIGHEST_PRIORITY, function(event) {\r\n    var shape = event.shape;\r\n\r\n    if (is(shape, 'bpmn:Lane')) {\r\n      event.shape = getLanesRoot(shape) || shape;\r\n    }\r\n  });\r\n\r\n}\r\n\r\nFixHoverBehavior.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas'\r\n];"],"mappings":"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"},"metadata":{},"sourceType":"module"}