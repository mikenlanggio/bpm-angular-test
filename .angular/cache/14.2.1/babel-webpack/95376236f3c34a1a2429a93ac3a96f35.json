{"ast":null,"code":"import { assign, filter, forEach, isNumber } from 'min-dash';\nimport { asTRBL } from '../../layout/LayoutUtil';\nimport { getBBox } from '../../util/Elements';\nimport { getDirection } from './SpaceUtil';\nimport { hasPrimaryModifier } from '../../util/Mouse';\nimport { set as setCursor } from '../../util/Cursor';\nimport { selfAndAllChildren } from '../../util/Elements';\nvar abs = Math.abs,\n    round = Math.round;\nvar AXIS_TO_DIMENSION = {\n  x: 'width',\n  y: 'height'\n};\nvar CURSOR_CROSSHAIR = 'crosshair';\nvar DIRECTION_TO_TRBL = {\n  n: 'top',\n  w: 'left',\n  s: 'bottom',\n  e: 'right'\n};\nvar HIGH_PRIORITY = 1500;\nvar DIRECTION_TO_OPPOSITE = {\n  n: 's',\n  w: 'e',\n  s: 'n',\n  e: 'w'\n};\nvar PADDING = 20;\n/**\n * Add or remove space by moving and resizing elements.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n * @param {ToolManager} toolManager\n * @param {Mouse} mouse\n */\n\nexport default function SpaceTool(canvas, dragging, eventBus, modeling, rules, toolManager, mouse) {\n  this._canvas = canvas;\n  this._dragging = dragging;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._toolManager = toolManager;\n  this._mouse = mouse;\n  var self = this;\n  toolManager.registerTool('space', {\n    tool: 'spaceTool.selection',\n    dragging: 'spaceTool'\n  });\n  eventBus.on('spaceTool.selection.end', function (event) {\n    eventBus.once('spaceTool.selection.ended', function () {\n      self.activateMakeSpace(event.originalEvent);\n    });\n  });\n  eventBus.on('spaceTool.move', HIGH_PRIORITY, function (event) {\n    var context = event.context,\n        initialized = context.initialized;\n\n    if (!initialized) {\n      initialized = context.initialized = self.init(event, context);\n    }\n\n    if (initialized) {\n      ensureConstraints(event);\n    }\n  });\n  eventBus.on('spaceTool.end', function (event) {\n    var context = event.context,\n        axis = context.axis,\n        direction = context.direction,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes,\n        start = context.start;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    ensureConstraints(event);\n    var delta = {\n      x: 0,\n      y: 0\n    };\n    delta[axis] = round(event['d' + axis]);\n    self.makeSpace(movingShapes, resizingShapes, delta, direction, start);\n    eventBus.once('spaceTool.ended', function (event) {\n      // activate space tool selection after make space\n      self.activateSelection(event.originalEvent, true, true);\n    });\n  });\n}\nSpaceTool.$inject = ['canvas', 'dragging', 'eventBus', 'modeling', 'rules', 'toolManager', 'mouse'];\n/**\n * Activate space tool selection.\n *\n * @param {Object} event\n * @param {boolean} autoActivate\n */\n\nSpaceTool.prototype.activateSelection = function (event, autoActivate, reactivate) {\n  this._dragging.init(event, 'spaceTool.selection', {\n    autoActivate: autoActivate,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    },\n    trapClick: false\n  });\n};\n/**\n * Activate space tool make space.\n *\n * @param  {MouseEvent} event\n */\n\n\nSpaceTool.prototype.activateMakeSpace = function (event) {\n  this._dragging.init(event, 'spaceTool', {\n    autoActivate: true,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {}\n    }\n  });\n};\n/**\n * Make space.\n *\n * @param  {Array<djs.model.Shape>} movingShapes\n * @param  {Array<djs.model.Shape>} resizingShapes\n * @param  {Object} delta\n * @param  {number} delta.x\n * @param  {number} delta.y\n * @param  {string} direction\n * @param  {number} start\n */\n\n\nSpaceTool.prototype.makeSpace = function (movingShapes, resizingShapes, delta, direction, start) {\n  return this._modeling.createSpace(movingShapes, resizingShapes, delta, direction, start);\n};\n/**\n * Initialize make space and return true if that was successful.\n *\n * @param {Object} event\n * @param {Object} context\n *\n * @return {boolean}\n */\n\n\nSpaceTool.prototype.init = function (event, context) {\n  var axis = abs(event.dx) > abs(event.dy) ? 'x' : 'y',\n      delta = event['d' + axis],\n      start = event[axis] - delta;\n\n  if (abs(delta) < 5) {\n    return false;\n  } // invert delta to remove space when moving left\n\n\n  if (delta < 0) {\n    delta *= -1;\n  } // invert delta to add/remove space when removing/adding space if modifier key is pressed\n\n\n  if (hasPrimaryModifier(event)) {\n    delta *= -1;\n  }\n\n  var direction = getDirection(axis, delta);\n\n  var root = this._canvas.getRootElement();\n\n  var children = selfAndAllChildren(root, true);\n  var elements = this.calculateAdjustments(children, axis, delta, start);\n\n  var minDimensions = this._eventBus.fire('spaceTool.getMinDimensions', {\n    axis: axis,\n    direction: direction,\n    shapes: elements.resizingShapes,\n    start: start\n  });\n\n  var spaceToolConstraints = getSpaceToolConstraints(elements, axis, direction, start, minDimensions);\n  assign(context, elements, {\n    axis: axis,\n    direction: direction,\n    spaceToolConstraints: spaceToolConstraints,\n    start: start\n  });\n  setCursor('resize-' + (axis === 'x' ? 'ew' : 'ns'));\n  return true;\n};\n/**\n * Get elements to be moved and resized.\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {string} axis\n * @param  {number} delta\n * @param  {number} start\n *\n * @return {Object}\n */\n\n\nSpaceTool.prototype.calculateAdjustments = function (elements, axis, delta, start) {\n  var rules = this._rules;\n  var movingShapes = [],\n      resizingShapes = [];\n  forEach(elements, function (element) {\n    if (!element.parent || isConnection(element)) {\n      return;\n    }\n\n    var shapeStart = element[axis],\n        shapeEnd = shapeStart + element[AXIS_TO_DIMENSION[axis]]; // shape to be moved\n\n    if (delta > 0 && shapeStart > start || delta < 0 && shapeEnd < start) {\n      return movingShapes.push(element);\n    } // shape to be resized\n\n\n    if (shapeStart < start && shapeEnd > start && rules.allowed('shape.resize', {\n      shape: element\n    })) {\n      return resizingShapes.push(element);\n    }\n  });\n  return {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes\n  };\n};\n\nSpaceTool.prototype.toggle = function () {\n  if (this.isActive()) {\n    return this._dragging.cancel();\n  }\n\n  var mouseEvent = this._mouse.getLastMoveEvent();\n\n  this.activateSelection(mouseEvent, !!mouseEvent);\n};\n\nSpaceTool.prototype.isActive = function () {\n  var context = this._dragging.context();\n\n  return context && /^spaceTool/.test(context.prefix);\n}; // helpers //////////\n\n\nfunction addPadding(trbl) {\n  return {\n    top: trbl.top - PADDING,\n    right: trbl.right + PADDING,\n    bottom: trbl.bottom + PADDING,\n    left: trbl.left - PADDING\n  };\n}\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      spaceToolConstraints = context.spaceToolConstraints;\n\n  if (!spaceToolConstraints) {\n    return;\n  }\n\n  var x, y;\n\n  if (isNumber(spaceToolConstraints.left)) {\n    x = Math.max(event.x, spaceToolConstraints.left);\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (isNumber(spaceToolConstraints.right)) {\n    x = Math.min(event.x, spaceToolConstraints.right);\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (isNumber(spaceToolConstraints.top)) {\n    y = Math.max(event.y, spaceToolConstraints.top);\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n\n  if (isNumber(spaceToolConstraints.bottom)) {\n    y = Math.min(event.y, spaceToolConstraints.bottom);\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n}\n\nfunction getSpaceToolConstraints(elements, axis, direction, start, minDimensions) {\n  var movingShapes = elements.movingShapes,\n      resizingShapes = elements.resizingShapes;\n\n  if (!resizingShapes.length) {\n    return;\n  }\n\n  var spaceToolConstraints = {},\n      min,\n      max;\n  forEach(resizingShapes, function (resizingShape) {\n    var resizingShapeBBox = asTRBL(resizingShape); // find children that are not moving or resizing\n\n    var nonMovingResizingChildren = filter(resizingShape.children, function (child) {\n      return !isConnection(child) && !isLabel(child) && !includes(movingShapes, child) && !includes(resizingShapes, child);\n    }); // find children that are moving\n\n    var movingChildren = filter(resizingShape.children, function (child) {\n      return !isConnection(child) && !isLabel(child) && includes(movingShapes, child);\n    });\n    var minOrMax, nonMovingResizingChildrenBBox, movingChildrenBBox;\n\n    if (nonMovingResizingChildren.length) {\n      nonMovingResizingChildrenBBox = addPadding(asTRBL(getBBox(nonMovingResizingChildren)));\n      minOrMax = start - resizingShapeBBox[DIRECTION_TO_TRBL[direction]] + nonMovingResizingChildrenBBox[DIRECTION_TO_TRBL[direction]];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    if (movingChildren.length) {\n      movingChildrenBBox = addPadding(asTRBL(getBBox(movingChildren)));\n      minOrMax = start - movingChildrenBBox[DIRECTION_TO_TRBL[DIRECTION_TO_OPPOSITE[direction]]] + resizingShapeBBox[DIRECTION_TO_TRBL[DIRECTION_TO_OPPOSITE[direction]]];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    var resizingShapeMinDimensions = minDimensions && minDimensions[resizingShape.id];\n\n    if (resizingShapeMinDimensions) {\n      if (direction === 'n') {\n        minOrMax = start + resizingShape[AXIS_TO_DIMENSION[axis]] - resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]];\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = start + resizingShape[AXIS_TO_DIMENSION[axis]] - resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]];\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = start - resizingShape[AXIS_TO_DIMENSION[axis]] + resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]];\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = start - resizingShape[AXIS_TO_DIMENSION[axis]] + resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]];\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n  });\n  return spaceToolConstraints;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}","map":{"version":3,"names":["assign","filter","forEach","isNumber","asTRBL","getBBox","getDirection","hasPrimaryModifier","set","setCursor","selfAndAllChildren","abs","Math","round","AXIS_TO_DIMENSION","x","y","CURSOR_CROSSHAIR","DIRECTION_TO_TRBL","n","w","s","e","HIGH_PRIORITY","DIRECTION_TO_OPPOSITE","PADDING","SpaceTool","canvas","dragging","eventBus","modeling","rules","toolManager","mouse","_canvas","_dragging","_eventBus","_modeling","_rules","_toolManager","_mouse","self","registerTool","tool","on","event","once","activateMakeSpace","originalEvent","context","initialized","init","ensureConstraints","axis","direction","movingShapes","resizingShapes","start","delta","makeSpace","activateSelection","$inject","prototype","autoActivate","reactivate","cursor","data","trapClick","createSpace","dx","dy","root","getRootElement","children","elements","calculateAdjustments","minDimensions","fire","shapes","spaceToolConstraints","getSpaceToolConstraints","element","parent","isConnection","shapeStart","shapeEnd","push","allowed","shape","toggle","isActive","cancel","mouseEvent","getLastMoveEvent","test","prefix","addPadding","trbl","top","right","bottom","left","max","min","length","resizingShape","resizingShapeBBox","nonMovingResizingChildren","child","isLabel","includes","movingChildren","minOrMax","nonMovingResizingChildrenBBox","movingChildrenBBox","resizingShapeMinDimensions","id","array","item","indexOf","waypoints","labelTarget"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/diagram-js/lib/features/space-tool/SpaceTool.js"],"sourcesContent":["import {\n  assign,\n  filter,\n  forEach,\n  isNumber\n} from 'min-dash';\n\nimport { asTRBL } from '../../layout/LayoutUtil';\n\nimport { getBBox } from '../../util/Elements';\n\nimport { getDirection } from './SpaceUtil';\n\nimport { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { set as setCursor } from '../../util/Cursor';\n\nimport { selfAndAllChildren } from '../../util/Elements';\n\nvar abs = Math.abs,\n    round = Math.round;\n\nvar AXIS_TO_DIMENSION = {\n  x: 'width',\n  y: 'height'\n};\n\nvar CURSOR_CROSSHAIR = 'crosshair';\n\nvar DIRECTION_TO_TRBL = {\n  n: 'top',\n  w: 'left',\n  s: 'bottom',\n  e: 'right'\n};\n\nvar HIGH_PRIORITY = 1500;\n\nvar DIRECTION_TO_OPPOSITE = {\n  n: 's',\n  w: 'e',\n  s: 'n',\n  e: 'w'\n};\n\nvar PADDING = 20;\n\n\n/**\n * Add or remove space by moving and resizing elements.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n * @param {ToolManager} toolManager\n * @param {Mouse} mouse\n */\nexport default function SpaceTool(\n    canvas, dragging, eventBus,\n    modeling, rules, toolManager,\n    mouse) {\n\n  this._canvas = canvas;\n  this._dragging = dragging;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._toolManager = toolManager;\n  this._mouse = mouse;\n\n  var self = this;\n\n  toolManager.registerTool('space', {\n    tool: 'spaceTool.selection',\n    dragging: 'spaceTool'\n  });\n\n  eventBus.on('spaceTool.selection.end', function(event) {\n    eventBus.once('spaceTool.selection.ended', function() {\n      self.activateMakeSpace(event.originalEvent);\n    });\n  });\n\n  eventBus.on('spaceTool.move', HIGH_PRIORITY , function(event) {\n    var context = event.context,\n        initialized = context.initialized;\n\n    if (!initialized) {\n      initialized = context.initialized = self.init(event, context);\n    }\n\n    if (initialized) {\n      ensureConstraints(event);\n    }\n  });\n\n  eventBus.on('spaceTool.end', function(event) {\n    var context = event.context,\n        axis = context.axis,\n        direction = context.direction,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes,\n        start = context.start;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    delta[ axis ] = round(event[ 'd' + axis ]);\n\n    self.makeSpace(movingShapes, resizingShapes, delta, direction, start);\n\n    eventBus.once('spaceTool.ended', function(event) {\n\n      // activate space tool selection after make space\n      self.activateSelection(event.originalEvent, true, true);\n    });\n  });\n}\n\nSpaceTool.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules',\n  'toolManager',\n  'mouse'\n];\n\n/**\n * Activate space tool selection.\n *\n * @param {Object} event\n * @param {boolean} autoActivate\n */\nSpaceTool.prototype.activateSelection = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'spaceTool.selection', {\n    autoActivate: autoActivate,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    },\n    trapClick: false\n  });\n};\n\n/**\n * Activate space tool make space.\n *\n * @param  {MouseEvent} event\n */\nSpaceTool.prototype.activateMakeSpace = function(event) {\n  this._dragging.init(event, 'spaceTool', {\n    autoActivate: true,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {}\n    }\n  });\n};\n\n/**\n * Make space.\n *\n * @param  {Array<djs.model.Shape>} movingShapes\n * @param  {Array<djs.model.Shape>} resizingShapes\n * @param  {Object} delta\n * @param  {number} delta.x\n * @param  {number} delta.y\n * @param  {string} direction\n * @param  {number} start\n */\nSpaceTool.prototype.makeSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  return this._modeling.createSpace(movingShapes, resizingShapes, delta, direction, start);\n};\n\n/**\n * Initialize make space and return true if that was successful.\n *\n * @param {Object} event\n * @param {Object} context\n *\n * @return {boolean}\n */\nSpaceTool.prototype.init = function(event, context) {\n  var axis = abs(event.dx) > abs(event.dy) ? 'x' : 'y',\n      delta = event[ 'd' + axis ],\n      start = event[ axis ] - delta;\n\n  if (abs(delta) < 5) {\n    return false;\n  }\n\n  // invert delta to remove space when moving left\n  if (delta < 0) {\n    delta *= -1;\n  }\n\n  // invert delta to add/remove space when removing/adding space if modifier key is pressed\n  if (hasPrimaryModifier(event)) {\n    delta *= -1;\n  }\n\n  var direction = getDirection(axis, delta);\n\n  var root = this._canvas.getRootElement();\n\n  var children = selfAndAllChildren(root, true);\n\n  var elements = this.calculateAdjustments(children, axis, delta, start);\n\n  var minDimensions = this._eventBus.fire('spaceTool.getMinDimensions', {\n    axis: axis,\n    direction: direction,\n    shapes: elements.resizingShapes,\n    start: start\n  });\n\n  var spaceToolConstraints = getSpaceToolConstraints(elements, axis, direction, start, minDimensions);\n\n  assign(\n    context,\n    elements,\n    {\n      axis: axis,\n      direction: direction,\n      spaceToolConstraints: spaceToolConstraints,\n      start: start\n    }\n  );\n\n  setCursor('resize-' + (axis === 'x' ? 'ew' : 'ns'));\n\n  return true;\n};\n\n/**\n * Get elements to be moved and resized.\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {string} axis\n * @param  {number} delta\n * @param  {number} start\n *\n * @return {Object}\n */\nSpaceTool.prototype.calculateAdjustments = function(elements, axis, delta, start) {\n  var rules = this._rules;\n\n  var movingShapes = [],\n      resizingShapes = [];\n\n  forEach(elements, function(element) {\n    if (!element.parent || isConnection(element)) {\n      return;\n    }\n\n    var shapeStart = element[ axis ],\n        shapeEnd = shapeStart + element[ AXIS_TO_DIMENSION[ axis ] ];\n\n    // shape to be moved\n    if ((delta > 0 && shapeStart > start) || (delta < 0 && shapeEnd < start)) {\n      return movingShapes.push(element);\n    }\n\n    // shape to be resized\n    if (shapeStart < start &&\n      shapeEnd > start &&\n      rules.allowed('shape.resize', { shape: element })\n    ) {\n\n      return resizingShapes.push(element);\n    }\n  });\n\n  return {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes\n  };\n};\n\nSpaceTool.prototype.toggle = function() {\n\n  if (this.isActive()) {\n    return this._dragging.cancel();\n  }\n\n  var mouseEvent = this._mouse.getLastMoveEvent();\n\n  this.activateSelection(mouseEvent, !!mouseEvent);\n};\n\nSpaceTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^spaceTool/.test(context.prefix);\n};\n\n// helpers //////////\n\nfunction addPadding(trbl) {\n  return {\n    top: trbl.top - PADDING,\n    right: trbl.right + PADDING,\n    bottom: trbl.bottom + PADDING,\n    left: trbl.left - PADDING\n  };\n}\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      spaceToolConstraints = context.spaceToolConstraints;\n\n  if (!spaceToolConstraints) {\n    return;\n  }\n\n  var x, y;\n\n  if (isNumber(spaceToolConstraints.left)) {\n    x = Math.max(event.x, spaceToolConstraints.left);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (isNumber(spaceToolConstraints.right)) {\n    x = Math.min(event.x, spaceToolConstraints.right);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (isNumber(spaceToolConstraints.top)) {\n    y = Math.max(event.y, spaceToolConstraints.top);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n\n  if (isNumber(spaceToolConstraints.bottom)) {\n    y = Math.min(event.y, spaceToolConstraints.bottom);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n}\n\nfunction getSpaceToolConstraints(elements, axis, direction, start, minDimensions) {\n  var movingShapes = elements.movingShapes,\n      resizingShapes = elements.resizingShapes;\n\n  if (!resizingShapes.length) {\n    return;\n  }\n\n  var spaceToolConstraints = {},\n      min,\n      max;\n\n  forEach(resizingShapes, function(resizingShape) {\n    var resizingShapeBBox = asTRBL(resizingShape);\n\n    // find children that are not moving or resizing\n    var nonMovingResizingChildren = filter(resizingShape.children, function(child) {\n      return !isConnection(child) &&\n        !isLabel(child) &&\n        !includes(movingShapes, child) &&\n        !includes(resizingShapes, child);\n    });\n\n    // find children that are moving\n    var movingChildren = filter(resizingShape.children, function(child) {\n      return !isConnection(child) && !isLabel(child) && includes(movingShapes, child);\n    });\n\n    var minOrMax,\n        nonMovingResizingChildrenBBox,\n        movingChildrenBBox;\n\n    if (nonMovingResizingChildren.length) {\n      nonMovingResizingChildrenBBox = addPadding(asTRBL(getBBox(nonMovingResizingChildren)));\n\n      minOrMax = start -\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ direction ] ] +\n        nonMovingResizingChildrenBBox[ DIRECTION_TO_TRBL[ direction ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    if (movingChildren.length) {\n      movingChildrenBBox = addPadding(asTRBL(getBBox(movingChildren)));\n\n      minOrMax = start -\n        movingChildrenBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ] +\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    var resizingShapeMinDimensions = minDimensions && minDimensions[ resizingShape.id ];\n\n    if (resizingShapeMinDimensions) {\n      if (direction === 'n') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n  });\n\n  return spaceToolConstraints;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}