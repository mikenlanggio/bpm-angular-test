{"ast":null,"code":"import { forEach } from 'min-dash';\nimport { getMovedSourceAnchor, getMovedTargetAnchor } from './AnchorsHelper';\nimport MoveClosure from './MoveClosure';\n/**\n * A helper that is able to carry out serialized move\n * operations on multiple elements.\n *\n * @param {Modeling} modeling\n */\n\nexport default function MoveHelper(modeling) {\n  this._modeling = modeling;\n}\n/**\n * Move the specified elements and all children by the given delta.\n *\n * This moves all enclosed connections, too and layouts all affected\n * external connections.\n *\n * @param  {Array<djs.model.Base>} elements\n * @param  {Point} delta\n * @param  {djs.model.Base} newParent applied to the first level of shapes\n *\n * @return {Array<djs.model.Base>} list of touched elements\n */\n\nMoveHelper.prototype.moveRecursive = function (elements, delta, newParent) {\n  if (!elements) {\n    return [];\n  } else {\n    return this.moveClosure(this.getClosure(elements), delta, newParent);\n  }\n};\n/**\n * Move the given closure of elmements.\n *\n * @param {Object} closure\n * @param {Point} delta\n * @param {djs.model.Base} [newParent]\n * @param {djs.model.Base} [newHost]\n */\n\n\nMoveHelper.prototype.moveClosure = function (closure, delta, newParent, newHost, primaryShape) {\n  var modeling = this._modeling;\n  var allShapes = closure.allShapes,\n      allConnections = closure.allConnections,\n      enclosedConnections = closure.enclosedConnections,\n      topLevel = closure.topLevel,\n      keepParent = false;\n\n  if (primaryShape && primaryShape.parent === newParent) {\n    keepParent = true;\n  } // move all shapes\n\n\n  forEach(allShapes, function (shape) {\n    // move the element according to the given delta\n    modeling.moveShape(shape, delta, topLevel[shape.id] && !keepParent && newParent, {\n      recurse: false,\n      layout: false\n    });\n  }); // move all child connections / layout external connections\n\n  forEach(allConnections, function (c) {\n    var sourceMoved = !!allShapes[c.source.id],\n        targetMoved = !!allShapes[c.target.id];\n\n    if (enclosedConnections[c.id] && sourceMoved && targetMoved) {\n      modeling.moveConnection(c, delta, topLevel[c.id] && !keepParent && newParent);\n    } else {\n      modeling.layoutConnection(c, {\n        connectionStart: sourceMoved && getMovedSourceAnchor(c, c.source, delta),\n        connectionEnd: targetMoved && getMovedTargetAnchor(c, c.target, delta)\n      });\n    }\n  });\n};\n/**\n * Returns the closure for the selected elements\n *\n * @param  {Array<djs.model.Base>} elements\n * @return {MoveClosure} closure\n */\n\n\nMoveHelper.prototype.getClosure = function (elements) {\n  return new MoveClosure().addAll(elements, true);\n};","map":{"version":3,"names":["forEach","getMovedSourceAnchor","getMovedTargetAnchor","MoveClosure","MoveHelper","modeling","_modeling","prototype","moveRecursive","elements","delta","newParent","moveClosure","getClosure","closure","newHost","primaryShape","allShapes","allConnections","enclosedConnections","topLevel","keepParent","parent","shape","moveShape","id","recurse","layout","c","sourceMoved","source","targetMoved","target","moveConnection","layoutConnection","connectionStart","connectionEnd","addAll"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveHelper.js"],"sourcesContent":["import {\n  forEach\n} from 'min-dash';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './AnchorsHelper';\n\nimport MoveClosure from './MoveClosure';\n\n\n/**\n * A helper that is able to carry out serialized move\n * operations on multiple elements.\n *\n * @param {Modeling} modeling\n */\nexport default function MoveHelper(modeling) {\n  this._modeling = modeling;\n}\n\n/**\n * Move the specified elements and all children by the given delta.\n *\n * This moves all enclosed connections, too and layouts all affected\n * external connections.\n *\n * @param  {Array<djs.model.Base>} elements\n * @param  {Point} delta\n * @param  {djs.model.Base} newParent applied to the first level of shapes\n *\n * @return {Array<djs.model.Base>} list of touched elements\n */\nMoveHelper.prototype.moveRecursive = function(elements, delta, newParent) {\n  if (!elements) {\n    return [];\n  } else {\n    return this.moveClosure(this.getClosure(elements), delta, newParent);\n  }\n};\n\n/**\n * Move the given closure of elmements.\n *\n * @param {Object} closure\n * @param {Point} delta\n * @param {djs.model.Base} [newParent]\n * @param {djs.model.Base} [newHost]\n */\nMoveHelper.prototype.moveClosure = function(closure, delta, newParent, newHost, primaryShape) {\n  var modeling = this._modeling;\n\n  var allShapes = closure.allShapes,\n      allConnections = closure.allConnections,\n      enclosedConnections = closure.enclosedConnections,\n      topLevel = closure.topLevel,\n      keepParent = false;\n\n  if (primaryShape && primaryShape.parent === newParent) {\n    keepParent = true;\n  }\n\n  // move all shapes\n  forEach(allShapes, function(shape) {\n\n    // move the element according to the given delta\n    modeling.moveShape(shape, delta, topLevel[shape.id] && !keepParent && newParent, {\n      recurse: false,\n      layout: false\n    });\n  });\n\n  // move all child connections / layout external connections\n  forEach(allConnections, function(c) {\n\n    var sourceMoved = !!allShapes[c.source.id],\n        targetMoved = !!allShapes[c.target.id];\n\n    if (enclosedConnections[c.id] && sourceMoved && targetMoved) {\n      modeling.moveConnection(c, delta, topLevel[c.id] && !keepParent && newParent);\n    } else {\n      modeling.layoutConnection(c, {\n        connectionStart: sourceMoved && getMovedSourceAnchor(c, c.source, delta),\n        connectionEnd: targetMoved && getMovedTargetAnchor(c, c.target, delta)\n      });\n    }\n  });\n};\n\n/**\n * Returns the closure for the selected elements\n *\n * @param  {Array<djs.model.Base>} elements\n * @return {MoveClosure} closure\n */\nMoveHelper.prototype.getClosure = function(elements) {\n  return new MoveClosure().addAll(elements, true);\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}