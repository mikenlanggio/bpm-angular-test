{"ast":null,"code":"import { assign, forEach, isFunction, isDefined, omit, size } from 'min-dash';\nimport { assignStyle, delegate as domDelegate, domify, classes as domClasses, attr as domAttr, query as domQuery, remove as domRemove } from 'min-dom';\nimport { escapeCSS } from '../../util/EscapeUtil';\nvar DATA_REF = 'data-id';\nvar CLOSE_EVENTS = ['contextPad.close', 'canvas.viewbox.changing', 'commandStack.changed'];\nvar DEFAULT_PRIORITY = 1000;\n/**\n * A popup menu that can be used to display a list of actions anywhere in the canvas.\n *\n * @param {Object} config\n * @param {boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {number} [config.scale.min]\n * @param {number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n *\n * @class\n * @constructor\n */\n\nexport default function PopupMenu(config, eventBus, canvas) {\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n  this._config = {\n    scale: scale\n  };\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._providers = {};\n  this._current = {};\n}\nPopupMenu.$inject = ['config.popupMenu', 'eventBus', 'canvas'];\n/**\n * Registers a popup menu provider\n *\n * @param  {string} id\n * @param {number} [priority=1000]\n * @param  {Object} provider\n *\n * @example\n * const popupMenuProvider = {\n *   getPopupMenuEntries: function(element) {\n *     return {\n *       'entry-1': {\n *         label: 'My Entry',\n *         action: function() { alert(\"I have been clicked!\"); }\n *       }\n *     }\n *   }\n * };\n *\n * popupMenu.registerProvider('myMenuID', popupMenuProvider);\n */\n\nPopupMenu.prototype.registerProvider = function (id, priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('popupMenu.getProviders.' + id, priority, function (event) {\n    event.providers.push(provider);\n  });\n};\n/**\n * Determine if the popup menu has entries.\n *\n * @return {boolean} true if empty\n */\n\n\nPopupMenu.prototype.isEmpty = function (element, providerId) {\n  if (!element) {\n    throw new Error('element parameter is missing');\n  }\n\n  if (!providerId) {\n    throw new Error('providerId parameter is missing');\n  }\n\n  var providers = this._getProviders(providerId);\n\n  if (!providers) {\n    return true;\n  }\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  var hasEntries = size(entries) > 0,\n      hasHeaderEntries = headerEntries && size(headerEntries) > 0;\n  return !hasEntries && !hasHeaderEntries;\n};\n/**\n * Create entries and open popup menu at given position\n *\n * @param  {Object} element\n * @param  {string} id provider id\n * @param  {Object} position\n *\n * @return {Object} popup menu instance\n */\n\n\nPopupMenu.prototype.open = function (element, id, position) {\n  var providers = this._getProviders(id);\n\n  if (!element) {\n    throw new Error('Element is missing');\n  }\n\n  if (!providers || !providers.length) {\n    throw new Error('No registered providers for: ' + id);\n  }\n\n  if (!position) {\n    throw new Error('the position argument is missing');\n  }\n\n  if (this.isOpen()) {\n    this.close();\n  }\n\n  this._emit('open');\n\n  var current = this._current = {\n    className: id,\n    element: element,\n    position: position\n  };\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  current.entries = assign({}, entries, headerEntries);\n  current.container = this._createContainer(id);\n\n  if (size(headerEntries)) {\n    current.container.appendChild(this._createEntries(headerEntries, 'djs-popup-header'));\n  }\n\n  if (size(entries)) {\n    current.container.appendChild(this._createEntries(entries, 'djs-popup-body'));\n  }\n\n  var canvas = this._canvas,\n      parent = canvas.getContainer();\n\n  this._attachContainer(current.container, parent, position.cursor);\n\n  this._bindAutoClose();\n};\n/**\n * Removes the popup menu and unbinds the event handlers.\n */\n\n\nPopupMenu.prototype.close = function () {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._emit('close');\n\n  this._unbindAutoClose();\n\n  domRemove(this._current.container);\n  this._current.container = null;\n};\n/**\n * Determine if an open popup menu exist.\n *\n * @return {boolean} true if open\n */\n\n\nPopupMenu.prototype.isOpen = function () {\n  return !!this._current.container;\n};\n/**\n * Trigger an action associated with an entry.\n *\n * @param {Object} event\n *\n * @return the result of the action callback, if any\n */\n\n\nPopupMenu.prototype.trigger = function (event) {\n  // silence other actions\n  event.preventDefault();\n  var element = event.delegateTarget || event.target,\n      entryId = domAttr(element, DATA_REF);\n\n  var entry = this._getEntry(entryId);\n\n  if (entry.action) {\n    return entry.action.call(null, event, entry);\n  }\n};\n\nPopupMenu.prototype._getProviders = function (id) {\n  var event = this._eventBus.createEvent({\n    type: 'popupMenu.getProviders.' + id,\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nPopupMenu.prototype._getEntries = function (element, providers) {\n  var entries = {};\n  forEach(providers, function (provider) {\n    // handle legacy method\n    if (!provider.getPopupMenuEntries) {\n      forEach(provider.getEntries(element), function (entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, ['id']);\n      });\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function (entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n  return entries;\n};\n\nPopupMenu.prototype._getHeaderEntries = function (element, providers) {\n  var entries = {};\n  forEach(providers, function (provider) {\n    // handle legacy method\n    if (!provider.getPopupMenuHeaderEntries) {\n      if (!provider.getHeaderEntries) {\n        return;\n      }\n\n      forEach(provider.getHeaderEntries(element), function (entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, ['id']);\n      });\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuHeaderEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function (entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n  return entries;\n};\n/**\n * Gets an entry instance (either entry or headerEntry) by id.\n *\n * @param  {string} entryId\n *\n * @return {Object} entry instance\n */\n\n\nPopupMenu.prototype._getEntry = function (entryId) {\n  var entry = this._current.entries[entryId];\n\n  if (!entry) {\n    throw new Error('entry not found');\n  }\n\n  return entry;\n};\n\nPopupMenu.prototype._emit = function (eventName) {\n  this._eventBus.fire('popupMenu.' + eventName);\n};\n/**\n * Creates the popup menu container.\n *\n * @return {Object} a DOM container\n */\n\n\nPopupMenu.prototype._createContainer = function (id) {\n  var container = domify('<div class=\"djs-popup\">'),\n      position = this._current.position,\n      className = this._current.className;\n  assignStyle(container, {\n    position: 'absolute',\n    left: position.x + 'px',\n    top: position.y + 'px',\n    visibility: 'hidden'\n  });\n  domClasses(container).add(className);\n  domAttr(container, 'data-popup', id);\n  return container;\n};\n/**\n * Attaches the container to the DOM.\n *\n * @param {Object} container\n * @param {Object} parent\n */\n\n\nPopupMenu.prototype._attachContainer = function (container, parent, cursor) {\n  var self = this; // Event handler\n\n  domDelegate.bind(container, '.entry', 'click', function (event) {\n    self.trigger(event);\n  });\n\n  this._updateScale(container); // Attach to DOM\n\n\n  parent.appendChild(container);\n\n  if (cursor) {\n    this._assureIsInbounds(container, cursor);\n  } // display after position adjustment to avoid flickering\n\n\n  assignStyle(container, {\n    visibility: 'visible'\n  });\n};\n/**\n * Updates popup style.transform with respect to the config and zoom level.\n *\n * @method _updateScale\n *\n * @param {Object} container\n */\n\n\nPopupMenu.prototype._updateScale = function (container) {\n  var zoom = this._canvas.zoom();\n\n  var scaleConfig = this._config.scale,\n      minScale,\n      maxScale,\n      scale = zoom;\n\n  if (scaleConfig !== true) {\n    if (scaleConfig === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = scaleConfig.min;\n      maxScale = scaleConfig.max;\n    }\n\n    if (isDefined(minScale) && zoom < minScale) {\n      scale = minScale;\n    }\n\n    if (isDefined(maxScale) && zoom > maxScale) {\n      scale = maxScale;\n    }\n  }\n\n  setTransform(container, 'scale(' + scale + ')');\n};\n/**\n * Make sure that the menu is always fully shown\n *\n * @method function\n *\n * @param  {Object} container\n * @param  {Position} cursor {x, y}\n */\n\n\nPopupMenu.prototype._assureIsInbounds = function (container, cursor) {\n  var canvas = this._canvas,\n      clientRect = canvas._container.getBoundingClientRect();\n\n  var containerX = container.offsetLeft,\n      containerY = container.offsetTop,\n      containerWidth = container.scrollWidth,\n      containerHeight = container.scrollHeight,\n      overAxis = {},\n      left,\n      top;\n  var cursorPosition = {\n    x: cursor.x - clientRect.left,\n    y: cursor.y - clientRect.top\n  };\n\n  if (containerX + containerWidth > clientRect.width) {\n    overAxis.x = true;\n  }\n\n  if (containerY + containerHeight > clientRect.height) {\n    overAxis.y = true;\n  }\n\n  if (overAxis.x && overAxis.y) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  } else if (overAxis.x) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y + 'px';\n  } else if (overAxis.y && cursorPosition.y < containerHeight) {\n    left = cursorPosition.x + 'px';\n    top = 10 + 'px';\n  } else if (overAxis.y) {\n    left = cursorPosition.x + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  }\n\n  assignStyle(container, {\n    left: left,\n    top: top\n  }, {\n    'zIndex': 1000\n  });\n};\n/**\n * Creates a list of entries and returns them as a DOM container.\n *\n * @param {Array<Object>} entries an array of entry objects\n * @param {string} className the class name of the entry container\n *\n * @return {Object} a DOM container\n */\n\n\nPopupMenu.prototype._createEntries = function (entries, className) {\n  var entriesContainer = domify('<div>'),\n      self = this;\n  domClasses(entriesContainer).add(className);\n  forEach(entries, function (entry, id) {\n    var entryContainer = self._createEntry(entry, id),\n        grouping = entry.group || 'default',\n        groupContainer = domQuery('[data-group=' + escapeCSS(grouping) + ']', entriesContainer);\n\n    if (!groupContainer) {\n      groupContainer = domify('<div class=\"group\"></div>');\n      domAttr(groupContainer, 'data-group', grouping);\n      entriesContainer.appendChild(groupContainer);\n    }\n\n    groupContainer.appendChild(entryContainer);\n  });\n  return entriesContainer;\n};\n/**\n * Creates a single entry and returns it as a DOM container.\n *\n * @param  {Object} entry\n *\n * @return {Object} a DOM container\n */\n\n\nPopupMenu.prototype._createEntry = function (entry, id) {\n  var entryContainer = domify('<div>'),\n      entryClasses = domClasses(entryContainer);\n  entryClasses.add('entry');\n\n  if (entry.className) {\n    entry.className.split(' ').forEach(function (className) {\n      entryClasses.add(className);\n    });\n  }\n\n  domAttr(entryContainer, DATA_REF, id);\n\n  if (entry.label) {\n    var label = domify('<span>');\n    label.textContent = entry.label;\n    entryContainer.appendChild(label);\n  }\n\n  if (entry.imageUrl) {\n    var image = domify('<img>');\n    domAttr(image, 'src', entry.imageUrl);\n    entryContainer.appendChild(image);\n  }\n\n  if (entry.active === true) {\n    entryClasses.add('active');\n  }\n\n  if (entry.disabled === true) {\n    entryClasses.add('disabled');\n  }\n\n  if (entry.title) {\n    entryContainer.title = entry.title;\n  }\n\n  return entryContainer;\n};\n/**\n * Set up listener to close popup automatically on certain events.\n */\n\n\nPopupMenu.prototype._bindAutoClose = function () {\n  this._eventBus.once(CLOSE_EVENTS, this.close, this);\n};\n/**\n * Remove the auto-closing listener.\n */\n\n\nPopupMenu.prototype._unbindAutoClose = function () {\n  this._eventBus.off(CLOSE_EVENTS, this.close, this);\n}; // helpers /////////////////////////////\n\n\nfunction setTransform(element, transform) {\n  element.style['transform-origin'] = 'top left';\n  ['', '-ms-', '-webkit-'].forEach(function (prefix) {\n    element.style[prefix + 'transform'] = transform;\n  });\n}","map":{"version":3,"names":["assign","forEach","isFunction","isDefined","omit","size","assignStyle","delegate","domDelegate","domify","classes","domClasses","attr","domAttr","query","domQuery","remove","domRemove","escapeCSS","DATA_REF","CLOSE_EVENTS","DEFAULT_PRIORITY","PopupMenu","config","eventBus","canvas","scale","min","max","_config","_eventBus","_canvas","_providers","_current","$inject","prototype","registerProvider","id","priority","provider","on","event","providers","push","isEmpty","element","providerId","Error","_getProviders","entries","_getEntries","headerEntries","_getHeaderEntries","hasEntries","hasHeaderEntries","open","position","length","isOpen","close","_emit","current","className","container","_createContainer","appendChild","_createEntries","parent","getContainer","_attachContainer","cursor","_bindAutoClose","_unbindAutoClose","trigger","preventDefault","delegateTarget","target","entryId","entry","_getEntry","action","call","createEvent","type","fire","getPopupMenuEntries","getEntries","entriesOrUpdater","getPopupMenuHeaderEntries","getHeaderEntries","eventName","left","x","top","y","visibility","add","self","bind","_updateScale","_assureIsInbounds","zoom","scaleConfig","minScale","maxScale","setTransform","clientRect","_container","getBoundingClientRect","containerX","offsetLeft","containerY","offsetTop","containerWidth","scrollWidth","containerHeight","scrollHeight","overAxis","cursorPosition","width","height","entriesContainer","entryContainer","_createEntry","grouping","group","groupContainer","entryClasses","split","label","textContent","imageUrl","image","active","disabled","title","once","off","transform","style","prefix"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/diagram-js/lib/features/popup-menu/PopupMenu.js"],"sourcesContent":["import {\n  assign,\n  forEach,\n  isFunction,\n  isDefined,\n  omit,\n  size\n} from 'min-dash';\n\nimport {\n  assignStyle,\n  delegate as domDelegate,\n  domify as domify,\n  classes as domClasses,\n  attr as domAttr,\n  query as domQuery,\n  remove as domRemove\n} from 'min-dom';\n\nimport {\n  escapeCSS\n} from '../../util/EscapeUtil';\n\nvar DATA_REF = 'data-id';\n\nvar CLOSE_EVENTS = [\n  'contextPad.close',\n  'canvas.viewbox.changing',\n  'commandStack.changed'\n];\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A popup menu that can be used to display a list of actions anywhere in the canvas.\n *\n * @param {Object} config\n * @param {boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {number} [config.scale.min]\n * @param {number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n *\n * @class\n * @constructor\n */\nexport default function PopupMenu(config, eventBus, canvas) {\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._config = {\n    scale: scale\n  };\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._providers = {};\n  this._current = {};\n}\n\nPopupMenu.$inject = [\n  'config.popupMenu',\n  'eventBus',\n  'canvas'\n];\n\n/**\n * Registers a popup menu provider\n *\n * @param  {string} id\n * @param {number} [priority=1000]\n * @param  {Object} provider\n *\n * @example\n * const popupMenuProvider = {\n *   getPopupMenuEntries: function(element) {\n *     return {\n *       'entry-1': {\n *         label: 'My Entry',\n *         action: function() { alert(\"I have been clicked!\"); }\n *       }\n *     }\n *   }\n * };\n *\n * popupMenu.registerProvider('myMenuID', popupMenuProvider);\n */\nPopupMenu.prototype.registerProvider = function(id, priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('popupMenu.getProviders.' + id, priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n/**\n * Determine if the popup menu has entries.\n *\n * @return {boolean} true if empty\n */\nPopupMenu.prototype.isEmpty = function(element, providerId) {\n  if (!element) {\n    throw new Error('element parameter is missing');\n  }\n\n  if (!providerId) {\n    throw new Error('providerId parameter is missing');\n  }\n\n  var providers = this._getProviders(providerId);\n\n  if (!providers) {\n    return true;\n  }\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  var hasEntries = size(entries) > 0,\n      hasHeaderEntries = headerEntries && size(headerEntries) > 0;\n\n  return !hasEntries && !hasHeaderEntries;\n};\n\n\n/**\n * Create entries and open popup menu at given position\n *\n * @param  {Object} element\n * @param  {string} id provider id\n * @param  {Object} position\n *\n * @return {Object} popup menu instance\n */\nPopupMenu.prototype.open = function(element, id, position) {\n\n  var providers = this._getProviders(id);\n\n  if (!element) {\n    throw new Error('Element is missing');\n  }\n\n  if (!providers || !providers.length) {\n    throw new Error('No registered providers for: ' + id);\n  }\n\n  if (!position) {\n    throw new Error('the position argument is missing');\n  }\n\n  if (this.isOpen()) {\n    this.close();\n  }\n\n  this._emit('open');\n\n  var current = this._current = {\n    className: id,\n    element: element,\n    position: position\n  };\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  current.entries = assign({}, entries, headerEntries);\n\n  current.container = this._createContainer(id);\n\n  if (size(headerEntries)) {\n    current.container.appendChild(\n      this._createEntries(headerEntries, 'djs-popup-header')\n    );\n  }\n\n  if (size(entries)) {\n    current.container.appendChild(\n      this._createEntries(entries, 'djs-popup-body')\n    );\n  }\n\n  var canvas = this._canvas,\n      parent = canvas.getContainer();\n\n  this._attachContainer(current.container, parent, position.cursor);\n  this._bindAutoClose();\n};\n\n\n/**\n * Removes the popup menu and unbinds the event handlers.\n */\nPopupMenu.prototype.close = function() {\n\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._emit('close');\n\n  this._unbindAutoClose();\n  domRemove(this._current.container);\n  this._current.container = null;\n};\n\n\n/**\n * Determine if an open popup menu exist.\n *\n * @return {boolean} true if open\n */\nPopupMenu.prototype.isOpen = function() {\n  return !!this._current.container;\n};\n\n\n/**\n * Trigger an action associated with an entry.\n *\n * @param {Object} event\n *\n * @return the result of the action callback, if any\n */\nPopupMenu.prototype.trigger = function(event) {\n\n  // silence other actions\n  event.preventDefault();\n\n  var element = event.delegateTarget || event.target,\n      entryId = domAttr(element, DATA_REF);\n\n  var entry = this._getEntry(entryId);\n\n  if (entry.action) {\n    return entry.action.call(null, event, entry);\n  }\n};\n\nPopupMenu.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'popupMenu.getProviders.' + id,\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nPopupMenu.prototype._getEntries = function(element, providers) {\n\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuEntries) {\n      forEach(provider.getEntries(element), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\nPopupMenu.prototype._getHeaderEntries = function(element, providers) {\n\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuHeaderEntries) {\n      if (!provider.getHeaderEntries) {\n        return;\n      }\n\n      forEach(provider.getHeaderEntries(element), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuHeaderEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n\n\n};\n\n/**\n * Gets an entry instance (either entry or headerEntry) by id.\n *\n * @param  {string} entryId\n *\n * @return {Object} entry instance\n */\nPopupMenu.prototype._getEntry = function(entryId) {\n\n  var entry = this._current.entries[entryId];\n\n  if (!entry) {\n    throw new Error('entry not found');\n  }\n\n  return entry;\n};\n\nPopupMenu.prototype._emit = function(eventName) {\n  this._eventBus.fire('popupMenu.' + eventName);\n};\n\n/**\n * Creates the popup menu container.\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createContainer = function(id) {\n  var container = domify('<div class=\"djs-popup\">'),\n      position = this._current.position,\n      className = this._current.className;\n\n  assignStyle(container, {\n    position: 'absolute',\n    left: position.x + 'px',\n    top: position.y + 'px',\n    visibility: 'hidden'\n  });\n\n  domClasses(container).add(className);\n\n  domAttr(container, 'data-popup', id);\n\n  return container;\n};\n\n\n/**\n * Attaches the container to the DOM.\n *\n * @param {Object} container\n * @param {Object} parent\n */\nPopupMenu.prototype._attachContainer = function(container, parent, cursor) {\n  var self = this;\n\n  // Event handler\n  domDelegate.bind(container, '.entry' ,'click', function(event) {\n    self.trigger(event);\n  });\n\n  this._updateScale(container);\n\n  // Attach to DOM\n  parent.appendChild(container);\n\n  if (cursor) {\n    this._assureIsInbounds(container, cursor);\n  }\n\n  // display after position adjustment to avoid flickering\n  assignStyle(container, { visibility: 'visible' });\n};\n\n\n/**\n * Updates popup style.transform with respect to the config and zoom level.\n *\n * @method _updateScale\n *\n * @param {Object} container\n */\nPopupMenu.prototype._updateScale = function(container) {\n  var zoom = this._canvas.zoom();\n\n  var scaleConfig = this._config.scale,\n      minScale,\n      maxScale,\n      scale = zoom;\n\n  if (scaleConfig !== true) {\n\n    if (scaleConfig === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = scaleConfig.min;\n      maxScale = scaleConfig.max;\n    }\n\n    if (isDefined(minScale) && zoom < minScale) {\n      scale = minScale;\n    }\n\n    if (isDefined(maxScale) && zoom > maxScale) {\n      scale = maxScale;\n    }\n\n  }\n\n  setTransform(container, 'scale(' + scale + ')');\n};\n\n\n/**\n * Make sure that the menu is always fully shown\n *\n * @method function\n *\n * @param  {Object} container\n * @param  {Position} cursor {x, y}\n */\nPopupMenu.prototype._assureIsInbounds = function(container, cursor) {\n  var canvas = this._canvas,\n      clientRect = canvas._container.getBoundingClientRect();\n\n  var containerX = container.offsetLeft,\n      containerY = container.offsetTop,\n      containerWidth = container.scrollWidth,\n      containerHeight = container.scrollHeight,\n      overAxis = {},\n      left, top;\n\n  var cursorPosition = {\n    x: cursor.x - clientRect.left,\n    y: cursor.y - clientRect.top\n  };\n\n  if (containerX + containerWidth > clientRect.width) {\n    overAxis.x = true;\n  }\n\n  if (containerY + containerHeight > clientRect.height) {\n    overAxis.y = true;\n  }\n\n  if (overAxis.x && overAxis.y) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  } else if (overAxis.x) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y + 'px';\n  } else if (overAxis.y && cursorPosition.y < containerHeight) {\n    left = cursorPosition.x + 'px';\n    top = 10 + 'px';\n  } else if (overAxis.y) {\n    left = cursorPosition.x + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  }\n\n  assignStyle(container, { left: left, top: top }, { 'zIndex': 1000 });\n};\n\n\n/**\n * Creates a list of entries and returns them as a DOM container.\n *\n * @param {Array<Object>} entries an array of entry objects\n * @param {string} className the class name of the entry container\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntries = function(entries, className) {\n\n  var entriesContainer = domify('<div>'),\n      self = this;\n\n  domClasses(entriesContainer).add(className);\n\n  forEach(entries, function(entry, id) {\n    var entryContainer = self._createEntry(entry, id),\n        grouping = entry.group || 'default',\n        groupContainer = domQuery('[data-group=' + escapeCSS(grouping) + ']', entriesContainer);\n\n    if (!groupContainer) {\n      groupContainer = domify('<div class=\"group\"></div>');\n      domAttr(groupContainer, 'data-group', grouping);\n\n      entriesContainer.appendChild(groupContainer);\n    }\n\n    groupContainer.appendChild(entryContainer);\n  });\n\n  return entriesContainer;\n};\n\n\n/**\n * Creates a single entry and returns it as a DOM container.\n *\n * @param  {Object} entry\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntry = function(entry, id) {\n\n  var entryContainer = domify('<div>'),\n      entryClasses = domClasses(entryContainer);\n\n  entryClasses.add('entry');\n\n  if (entry.className) {\n    entry.className.split(' ').forEach(function(className) {\n      entryClasses.add(className);\n    });\n  }\n\n  domAttr(entryContainer, DATA_REF, id);\n\n  if (entry.label) {\n    var label = domify('<span>');\n    label.textContent = entry.label;\n    entryContainer.appendChild(label);\n  }\n\n  if (entry.imageUrl) {\n    var image = domify('<img>');\n    domAttr(image, 'src', entry.imageUrl);\n\n    entryContainer.appendChild(image);\n  }\n\n  if (entry.active === true) {\n    entryClasses.add('active');\n  }\n\n  if (entry.disabled === true) {\n    entryClasses.add('disabled');\n  }\n\n  if (entry.title) {\n    entryContainer.title = entry.title;\n  }\n\n  return entryContainer;\n};\n\n\n/**\n * Set up listener to close popup automatically on certain events.\n */\nPopupMenu.prototype._bindAutoClose = function() {\n  this._eventBus.once(CLOSE_EVENTS, this.close, this);\n};\n\n\n/**\n * Remove the auto-closing listener.\n */\nPopupMenu.prototype._unbindAutoClose = function() {\n  this._eventBus.off(CLOSE_EVENTS, this.close, this);\n};\n\n\n\n// helpers /////////////////////////////\n\nfunction setTransform(element, transform) {\n  element.style['transform-origin'] = 'top left';\n\n  [ '', '-ms-', '-webkit-' ].forEach(function(prefix) {\n    element.style[prefix + 'transform'] = transform;\n  });\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}