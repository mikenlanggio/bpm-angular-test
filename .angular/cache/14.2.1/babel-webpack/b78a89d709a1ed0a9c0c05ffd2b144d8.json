{"ast":null,"code":"import { hasPrimaryModifier } from '../../util/Mouse';\nimport { isKey } from '../../features/keyboard/KeyboardUtil';\nvar HIGH_PRIORITY = 1500;\nvar HAND_CURSOR = 'grab';\nexport default function HandTool(eventBus, canvas, dragging, injector, toolManager, mouse) {\n  this._dragging = dragging;\n  this._mouse = mouse;\n  var self = this,\n      keyboard = injector.get('keyboard', false);\n  toolManager.registerTool('hand', {\n    tool: 'hand',\n    dragging: 'hand.move'\n  });\n  eventBus.on('element.mousedown', HIGH_PRIORITY, function (event) {\n    if (!hasPrimaryModifier(event)) {\n      return;\n    }\n\n    self.activateMove(event.originalEvent, true);\n    return false;\n  });\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function (e) {\n    if (!isSpace(e.keyEvent) || self.isActive()) {\n      return;\n    }\n\n    var mouseEvent = self._mouse.getLastMoveEvent();\n\n    self.activateMove(mouseEvent, !!mouseEvent);\n  }, 'keyboard.keydown');\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function (e) {\n    if (!isSpace(e.keyEvent) || !self.isActive()) {\n      return;\n    }\n\n    self.toggle();\n  }, 'keyboard.keyup');\n  eventBus.on('hand.end', function (event) {\n    var target = event.originalEvent.target; // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return false;\n    }\n\n    eventBus.once('hand.ended', function () {\n      self.activateMove(event.originalEvent, {\n        reactivate: true\n      });\n    });\n  });\n  eventBus.on('hand.move.move', function (event) {\n    var scale = canvas.viewbox().scale;\n    canvas.scroll({\n      dx: event.dx * scale,\n      dy: event.dy * scale\n    });\n  });\n  eventBus.on('hand.move.end', function (event) {\n    var context = event.context,\n        reactivate = context.reactivate; // Don't reactivate if the user is using the keyboard keybinding\n\n    if (!hasPrimaryModifier(event) && reactivate) {\n      eventBus.once('hand.move.ended', function (event) {\n        self.activateHand(event.originalEvent, true, true);\n      });\n    }\n\n    return false;\n  });\n}\nHandTool.$inject = ['eventBus', 'canvas', 'dragging', 'injector', 'toolManager', 'mouse'];\n\nHandTool.prototype.activateMove = function (event, autoActivate, context) {\n  if (typeof autoActivate === 'object') {\n    context = autoActivate;\n    autoActivate = false;\n  }\n\n  this._dragging.init(event, 'hand.move', {\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: context || {}\n    }\n  });\n};\n\nHandTool.prototype.activateHand = function (event, autoActivate, reactivate) {\n  this._dragging.init(event, 'hand', {\n    trapClick: false,\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    }\n  });\n};\n\nHandTool.prototype.toggle = function () {\n  if (this.isActive()) {\n    return this._dragging.cancel();\n  }\n\n  var mouseEvent = this._mouse.getLastMoveEvent();\n\n  this.activateHand(mouseEvent, !!mouseEvent);\n};\n\nHandTool.prototype.isActive = function () {\n  var context = this._dragging.context();\n\n  if (context) {\n    return /^(hand|hand\\.move)$/.test(context.prefix);\n  }\n\n  return false;\n}; // helpers //////////\n\n\nfunction isSpace(keyEvent) {\n  return isKey(' ', keyEvent);\n}","map":{"version":3,"names":["hasPrimaryModifier","isKey","HIGH_PRIORITY","HAND_CURSOR","HandTool","eventBus","canvas","dragging","injector","toolManager","mouse","_dragging","_mouse","self","keyboard","get","registerTool","tool","on","event","activateMove","originalEvent","addListener","e","isSpace","keyEvent","isActive","mouseEvent","getLastMoveEvent","toggle","target","hover","SVGElement","once","reactivate","scale","viewbox","scroll","dx","dy","context","activateHand","$inject","prototype","autoActivate","init","cursor","data","trapClick","cancel","test","prefix"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/diagram-js/lib/features/hand-tool/HandTool.js"],"sourcesContent":["import {\n  hasPrimaryModifier\n} from '../../util/Mouse';\n\nimport { isKey } from '../../features/keyboard/KeyboardUtil';\n\nvar HIGH_PRIORITY = 1500;\nvar HAND_CURSOR = 'grab';\n\n\nexport default function HandTool(\n    eventBus, canvas, dragging,\n    injector, toolManager, mouse) {\n\n  this._dragging = dragging;\n  this._mouse = mouse;\n\n  var self = this,\n      keyboard = injector.get('keyboard', false);\n\n  toolManager.registerTool('hand', {\n    tool: 'hand',\n    dragging: 'hand.move'\n  });\n\n  eventBus.on('element.mousedown', HIGH_PRIORITY, function(event) {\n\n    if (!hasPrimaryModifier(event)) {\n      return;\n    }\n\n    self.activateMove(event.originalEvent, true);\n\n    return false;\n  });\n\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function(e) {\n    if (!isSpace(e.keyEvent) || self.isActive()) {\n      return;\n    }\n\n    var mouseEvent = self._mouse.getLastMoveEvent();\n\n    self.activateMove(mouseEvent, !!mouseEvent);\n  }, 'keyboard.keydown');\n\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function(e) {\n    if (!isSpace(e.keyEvent) || !self.isActive()) {\n      return;\n    }\n\n    self.toggle();\n  }, 'keyboard.keyup');\n\n  eventBus.on('hand.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return false;\n    }\n\n    eventBus.once('hand.ended', function() {\n      self.activateMove(event.originalEvent, { reactivate: true });\n    });\n\n  });\n\n  eventBus.on('hand.move.move', function(event) {\n    var scale = canvas.viewbox().scale;\n\n    canvas.scroll({\n      dx: event.dx * scale,\n      dy: event.dy * scale\n    });\n  });\n\n  eventBus.on('hand.move.end', function(event) {\n    var context = event.context,\n        reactivate = context.reactivate;\n\n    // Don't reactivate if the user is using the keyboard keybinding\n    if (!hasPrimaryModifier(event) && reactivate) {\n\n      eventBus.once('hand.move.ended', function(event) {\n        self.activateHand(event.originalEvent, true, true);\n      });\n\n    }\n\n    return false;\n  });\n\n}\n\nHandTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'injector',\n  'toolManager',\n  'mouse'\n];\n\n\nHandTool.prototype.activateMove = function(event, autoActivate, context) {\n  if (typeof autoActivate === 'object') {\n    context = autoActivate;\n    autoActivate = false;\n  }\n\n  this._dragging.init(event, 'hand.move', {\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: context || {}\n    }\n  });\n};\n\nHandTool.prototype.activateHand = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'hand', {\n    trapClick: false,\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    }\n  });\n};\n\nHandTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    return this._dragging.cancel();\n  }\n\n  var mouseEvent = this._mouse.getLastMoveEvent();\n\n  this.activateHand(mouseEvent, !!mouseEvent);\n};\n\nHandTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  if (context) {\n    return /^(hand|hand\\.move)$/.test(context.prefix);\n  }\n\n  return false;\n};\n\n// helpers //////////\n\nfunction isSpace(keyEvent) {\n  return isKey(' ', keyEvent);\n}"],"mappings":"AAAA,SACEA,kBADF,QAEO,kBAFP;AAIA,SAASC,KAAT,QAAsB,sCAAtB;AAEA,IAAIC,aAAa,GAAG,IAApB;AACA,IAAIC,WAAW,GAAG,MAAlB;AAGA,eAAe,SAASC,QAAT,CACXC,QADW,EACDC,MADC,EACOC,QADP,EAEXC,QAFW,EAEDC,WAFC,EAEYC,KAFZ,EAEmB;EAEhC,KAAKC,SAAL,GAAiBJ,QAAjB;EACA,KAAKK,MAAL,GAAcF,KAAd;EAEA,IAAIG,IAAI,GAAG,IAAX;EAAA,IACIC,QAAQ,GAAGN,QAAQ,CAACO,GAAT,CAAa,UAAb,EAAyB,KAAzB,CADf;EAGAN,WAAW,CAACO,YAAZ,CAAyB,MAAzB,EAAiC;IAC/BC,IAAI,EAAE,MADyB;IAE/BV,QAAQ,EAAE;EAFqB,CAAjC;EAKAF,QAAQ,CAACa,EAAT,CAAY,mBAAZ,EAAiChB,aAAjC,EAAgD,UAASiB,KAAT,EAAgB;IAE9D,IAAI,CAACnB,kBAAkB,CAACmB,KAAD,CAAvB,EAAgC;MAC9B;IACD;;IAEDN,IAAI,CAACO,YAAL,CAAkBD,KAAK,CAACE,aAAxB,EAAuC,IAAvC;IAEA,OAAO,KAAP;EACD,CATD;EAWAP,QAAQ,IAAIA,QAAQ,CAACQ,WAAT,CAAqBpB,aAArB,EAAoC,UAASqB,CAAT,EAAY;IAC1D,IAAI,CAACC,OAAO,CAACD,CAAC,CAACE,QAAH,CAAR,IAAwBZ,IAAI,CAACa,QAAL,EAA5B,EAA6C;MAC3C;IACD;;IAED,IAAIC,UAAU,GAAGd,IAAI,CAACD,MAAL,CAAYgB,gBAAZ,EAAjB;;IAEAf,IAAI,CAACO,YAAL,CAAkBO,UAAlB,EAA8B,CAAC,CAACA,UAAhC;EACD,CARW,EAQT,kBARS,CAAZ;EAUAb,QAAQ,IAAIA,QAAQ,CAACQ,WAAT,CAAqBpB,aAArB,EAAoC,UAASqB,CAAT,EAAY;IAC1D,IAAI,CAACC,OAAO,CAACD,CAAC,CAACE,QAAH,CAAR,IAAwB,CAACZ,IAAI,CAACa,QAAL,EAA7B,EAA8C;MAC5C;IACD;;IAEDb,IAAI,CAACgB,MAAL;EACD,CANW,EAMT,gBANS,CAAZ;EAQAxB,QAAQ,CAACa,EAAT,CAAY,UAAZ,EAAwB,UAASC,KAAT,EAAgB;IACtC,IAAIW,MAAM,GAAGX,KAAK,CAACE,aAAN,CAAoBS,MAAjC,CADsC,CAGtC;IACA;;IACA,IAAI,CAACX,KAAK,CAACY,KAAP,IAAgB,EAAED,MAAM,YAAYE,UAApB,CAApB,EAAqD;MACnD,OAAO,KAAP;IACD;;IAED3B,QAAQ,CAAC4B,IAAT,CAAc,YAAd,EAA4B,YAAW;MACrCpB,IAAI,CAACO,YAAL,CAAkBD,KAAK,CAACE,aAAxB,EAAuC;QAAEa,UAAU,EAAE;MAAd,CAAvC;IACD,CAFD;EAID,CAbD;EAeA7B,QAAQ,CAACa,EAAT,CAAY,gBAAZ,EAA8B,UAASC,KAAT,EAAgB;IAC5C,IAAIgB,KAAK,GAAG7B,MAAM,CAAC8B,OAAP,GAAiBD,KAA7B;IAEA7B,MAAM,CAAC+B,MAAP,CAAc;MACZC,EAAE,EAAEnB,KAAK,CAACmB,EAAN,GAAWH,KADH;MAEZI,EAAE,EAAEpB,KAAK,CAACoB,EAAN,GAAWJ;IAFH,CAAd;EAID,CAPD;EASA9B,QAAQ,CAACa,EAAT,CAAY,eAAZ,EAA6B,UAASC,KAAT,EAAgB;IAC3C,IAAIqB,OAAO,GAAGrB,KAAK,CAACqB,OAApB;IAAA,IACIN,UAAU,GAAGM,OAAO,CAACN,UADzB,CAD2C,CAI3C;;IACA,IAAI,CAAClC,kBAAkB,CAACmB,KAAD,CAAnB,IAA8Be,UAAlC,EAA8C;MAE5C7B,QAAQ,CAAC4B,IAAT,CAAc,iBAAd,EAAiC,UAASd,KAAT,EAAgB;QAC/CN,IAAI,CAAC4B,YAAL,CAAkBtB,KAAK,CAACE,aAAxB,EAAuC,IAAvC,EAA6C,IAA7C;MACD,CAFD;IAID;;IAED,OAAO,KAAP;EACD,CAdD;AAgBD;AAEDjB,QAAQ,CAACsC,OAAT,GAAmB,CACjB,UADiB,EAEjB,QAFiB,EAGjB,UAHiB,EAIjB,UAJiB,EAKjB,aALiB,EAMjB,OANiB,CAAnB;;AAUAtC,QAAQ,CAACuC,SAAT,CAAmBvB,YAAnB,GAAkC,UAASD,KAAT,EAAgByB,YAAhB,EAA8BJ,OAA9B,EAAuC;EACvE,IAAI,OAAOI,YAAP,KAAwB,QAA5B,EAAsC;IACpCJ,OAAO,GAAGI,YAAV;IACAA,YAAY,GAAG,KAAf;EACD;;EAED,KAAKjC,SAAL,CAAekC,IAAf,CAAoB1B,KAApB,EAA2B,WAA3B,EAAwC;IACtCyB,YAAY,EAAEA,YADwB;IAEtCE,MAAM,EAAE3C,WAF8B;IAGtC4C,IAAI,EAAE;MACJP,OAAO,EAAEA,OAAO,IAAI;IADhB;EAHgC,CAAxC;AAOD,CAbD;;AAeApC,QAAQ,CAACuC,SAAT,CAAmBF,YAAnB,GAAkC,UAAStB,KAAT,EAAgByB,YAAhB,EAA8BV,UAA9B,EAA0C;EAC1E,KAAKvB,SAAL,CAAekC,IAAf,CAAoB1B,KAApB,EAA2B,MAA3B,EAAmC;IACjC6B,SAAS,EAAE,KADsB;IAEjCJ,YAAY,EAAEA,YAFmB;IAGjCE,MAAM,EAAE3C,WAHyB;IAIjC4C,IAAI,EAAE;MACJP,OAAO,EAAE;QACPN,UAAU,EAAEA;MADL;IADL;EAJ2B,CAAnC;AAUD,CAXD;;AAaA9B,QAAQ,CAACuC,SAAT,CAAmBd,MAAnB,GAA4B,YAAW;EACrC,IAAI,KAAKH,QAAL,EAAJ,EAAqB;IACnB,OAAO,KAAKf,SAAL,CAAesC,MAAf,EAAP;EACD;;EAED,IAAItB,UAAU,GAAG,KAAKf,MAAL,CAAYgB,gBAAZ,EAAjB;;EAEA,KAAKa,YAAL,CAAkBd,UAAlB,EAA8B,CAAC,CAACA,UAAhC;AACD,CARD;;AAUAvB,QAAQ,CAACuC,SAAT,CAAmBjB,QAAnB,GAA8B,YAAW;EACvC,IAAIc,OAAO,GAAG,KAAK7B,SAAL,CAAe6B,OAAf,EAAd;;EAEA,IAAIA,OAAJ,EAAa;IACX,OAAO,sBAAsBU,IAAtB,CAA2BV,OAAO,CAACW,MAAnC,CAAP;EACD;;EAED,OAAO,KAAP;AACD,CARD,C,CAUA;;;AAEA,SAAS3B,OAAT,CAAiBC,QAAjB,EAA2B;EACzB,OAAOxB,KAAK,CAAC,GAAD,EAAMwB,QAAN,CAAZ;AACD"},"metadata":{},"sourceType":"module"}