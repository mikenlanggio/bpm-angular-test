{"ast":null,"code":"import { bind, forEach } from 'min-dash';\nimport { append as svgAppend, attr as svgAttr, classes as svgClasses, clear as svgClear, create as svgCreate } from 'tiny-svg';\nimport { event as domEvent } from 'min-dom';\nimport { isPrimaryButton } from '../../util/Mouse';\nimport { transform } from '../../util/SvgTransformUtil';\nimport { getReferencePoint } from './Resize';\nvar HANDLE_OFFSET = -6,\n    HANDLE_SIZE = 8,\n    HANDLE_HIT_SIZE = 20;\nvar CLS_RESIZER = 'djs-resizer';\nvar directions = ['n', 'w', 's', 'e', 'nw', 'ne', 'se', 'sw'];\n/**\n * This component is responsible for adding resize handles.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Selection} selection\n * @param {Resize} resize\n */\n\nexport default function ResizeHandles(eventBus, canvas, selection, resize) {\n  this._resize = resize;\n  this._canvas = canvas;\n  var self = this;\n  eventBus.on('selection.changed', function (e) {\n    var newSelection = e.newSelection; // remove old selection markers\n\n    self.removeResizers(); // add new selection markers ONLY if single selection\n\n    if (newSelection.length === 1) {\n      forEach(newSelection, bind(self.addResizer, self));\n    }\n  });\n  eventBus.on('shape.changed', function (e) {\n    var shape = e.element;\n\n    if (selection.isSelected(shape)) {\n      self.removeResizers();\n      self.addResizer(shape);\n    }\n  });\n}\n\nResizeHandles.prototype.makeDraggable = function (element, gfx, direction) {\n  var resize = this._resize;\n\n  function startResize(event) {\n    // only trigger on left mouse button\n    if (isPrimaryButton(event)) {\n      resize.activate(event, element, direction);\n    }\n  }\n\n  domEvent.bind(gfx, 'mousedown', startResize);\n  domEvent.bind(gfx, 'touchstart', startResize);\n};\n\nResizeHandles.prototype._createResizer = function (element, x, y, direction) {\n  var resizersParent = this._getResizersParent();\n\n  var offset = getHandleOffset(direction);\n  var group = svgCreate('g');\n  svgClasses(group).add(CLS_RESIZER);\n  svgClasses(group).add(CLS_RESIZER + '-' + element.id);\n  svgClasses(group).add(CLS_RESIZER + '-' + direction);\n  svgAppend(resizersParent, group);\n  var visual = svgCreate('rect');\n  svgAttr(visual, {\n    x: -HANDLE_SIZE / 2 + offset.x,\n    y: -HANDLE_SIZE / 2 + offset.y,\n    width: HANDLE_SIZE,\n    height: HANDLE_SIZE\n  });\n  svgClasses(visual).add(CLS_RESIZER + '-visual');\n  svgAppend(group, visual);\n  var hit = svgCreate('rect');\n  svgAttr(hit, {\n    x: -HANDLE_HIT_SIZE / 2 + offset.x,\n    y: -HANDLE_HIT_SIZE / 2 + offset.y,\n    width: HANDLE_HIT_SIZE,\n    height: HANDLE_HIT_SIZE\n  });\n  svgClasses(hit).add(CLS_RESIZER + '-hit');\n  svgAppend(group, hit);\n  transform(group, x, y);\n  return group;\n};\n\nResizeHandles.prototype.createResizer = function (element, direction) {\n  var point = getReferencePoint(element, direction);\n\n  var resizer = this._createResizer(element, point.x, point.y, direction);\n\n  this.makeDraggable(element, resizer, direction);\n}; // resize handles implementation ///////////////////////////////\n\n/**\n * Add resizers for a given element.\n *\n * @param {djs.model.Element} element\n */\n\n\nResizeHandles.prototype.addResizer = function (element) {\n  var self = this;\n\n  if (isConnection(element) || !this._resize.canResize({\n    shape: element\n  })) {\n    return;\n  }\n\n  forEach(directions, function (direction) {\n    self.createResizer(element, direction);\n  });\n};\n/**\n * Remove all resizers\n */\n\n\nResizeHandles.prototype.removeResizers = function () {\n  var resizersParent = this._getResizersParent();\n\n  svgClear(resizersParent);\n};\n\nResizeHandles.prototype._getResizersParent = function () {\n  return this._canvas.getLayer('resizers');\n};\n\nResizeHandles.$inject = ['eventBus', 'canvas', 'selection', 'resize']; // helpers //////////\n\nfunction getHandleOffset(direction) {\n  var offset = {\n    x: 0,\n    y: 0\n  };\n\n  if (direction.indexOf('e') !== -1) {\n    offset.x = -HANDLE_OFFSET;\n  } else if (direction.indexOf('w') !== -1) {\n    offset.x = HANDLE_OFFSET;\n  }\n\n  if (direction.indexOf('s') !== -1) {\n    offset.y = -HANDLE_OFFSET;\n  } else if (direction.indexOf('n') !== -1) {\n    offset.y = HANDLE_OFFSET;\n  }\n\n  return offset;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}","map":{"version":3,"names":["bind","forEach","append","svgAppend","attr","svgAttr","classes","svgClasses","clear","svgClear","create","svgCreate","event","domEvent","isPrimaryButton","transform","getReferencePoint","HANDLE_OFFSET","HANDLE_SIZE","HANDLE_HIT_SIZE","CLS_RESIZER","directions","ResizeHandles","eventBus","canvas","selection","resize","_resize","_canvas","self","on","e","newSelection","removeResizers","length","addResizer","shape","element","isSelected","prototype","makeDraggable","gfx","direction","startResize","activate","_createResizer","x","y","resizersParent","_getResizersParent","offset","getHandleOffset","group","add","id","visual","width","height","hit","createResizer","point","resizer","isConnection","canResize","getLayer","$inject","indexOf","waypoints"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/diagram-js/lib/features/resize/ResizeHandles.js"],"sourcesContent":["import {\n  bind,\n  forEach\n} from 'min-dash';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  clear as svgClear,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  isPrimaryButton\n} from '../../util/Mouse';\n\nimport {\n  transform\n} from '../../util/SvgTransformUtil';\n\nimport { getReferencePoint } from './Resize';\n\nvar HANDLE_OFFSET = -6,\n    HANDLE_SIZE = 8,\n    HANDLE_HIT_SIZE = 20;\n\nvar CLS_RESIZER = 'djs-resizer';\n\nvar directions = [ 'n', 'w', 's', 'e', 'nw', 'ne', 'se', 'sw' ];\n\n\n/**\n * This component is responsible for adding resize handles.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Selection} selection\n * @param {Resize} resize\n */\nexport default function ResizeHandles(eventBus, canvas, selection, resize) {\n\n  this._resize = resize;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n    var newSelection = e.newSelection;\n\n    // remove old selection markers\n    self.removeResizers();\n\n    // add new selection markers ONLY if single selection\n    if (newSelection.length === 1) {\n      forEach(newSelection, bind(self.addResizer, self));\n    }\n  });\n\n  eventBus.on('shape.changed', function(e) {\n    var shape = e.element;\n\n    if (selection.isSelected(shape)) {\n      self.removeResizers();\n\n      self.addResizer(shape);\n    }\n  });\n}\n\n\nResizeHandles.prototype.makeDraggable = function(element, gfx, direction) {\n  var resize = this._resize;\n\n  function startResize(event) {\n\n    // only trigger on left mouse button\n    if (isPrimaryButton(event)) {\n      resize.activate(event, element, direction);\n    }\n  }\n\n  domEvent.bind(gfx, 'mousedown', startResize);\n  domEvent.bind(gfx, 'touchstart', startResize);\n};\n\n\nResizeHandles.prototype._createResizer = function(element, x, y, direction) {\n  var resizersParent = this._getResizersParent();\n\n  var offset = getHandleOffset(direction);\n\n  var group = svgCreate('g');\n\n  svgClasses(group).add(CLS_RESIZER);\n  svgClasses(group).add(CLS_RESIZER + '-' + element.id);\n  svgClasses(group).add(CLS_RESIZER + '-' + direction);\n\n  svgAppend(resizersParent, group);\n\n  var visual = svgCreate('rect');\n\n  svgAttr(visual, {\n    x: -HANDLE_SIZE / 2 + offset.x,\n    y: -HANDLE_SIZE / 2 + offset.y,\n    width: HANDLE_SIZE,\n    height: HANDLE_SIZE\n  });\n\n  svgClasses(visual).add(CLS_RESIZER + '-visual');\n\n  svgAppend(group, visual);\n\n  var hit = svgCreate('rect');\n\n  svgAttr(hit, {\n    x: -HANDLE_HIT_SIZE / 2 + offset.x,\n    y: -HANDLE_HIT_SIZE / 2 + offset.y,\n    width: HANDLE_HIT_SIZE,\n    height: HANDLE_HIT_SIZE\n  });\n\n  svgClasses(hit).add(CLS_RESIZER + '-hit');\n\n  svgAppend(group, hit);\n\n  transform(group, x, y);\n\n  return group;\n};\n\nResizeHandles.prototype.createResizer = function(element, direction) {\n  var point = getReferencePoint(element, direction);\n\n  var resizer = this._createResizer(element, point.x, point.y, direction);\n\n  this.makeDraggable(element, resizer, direction);\n};\n\n// resize handles implementation ///////////////////////////////\n\n/**\n * Add resizers for a given element.\n *\n * @param {djs.model.Element} element\n */\nResizeHandles.prototype.addResizer = function(element) {\n  var self = this;\n\n  if (isConnection(element) || !this._resize.canResize({ shape: element })) {\n    return;\n  }\n\n  forEach(directions, function(direction) {\n    self.createResizer(element, direction);\n  });\n};\n\n/**\n * Remove all resizers\n */\nResizeHandles.prototype.removeResizers = function() {\n  var resizersParent = this._getResizersParent();\n\n  svgClear(resizersParent);\n};\n\nResizeHandles.prototype._getResizersParent = function() {\n  return this._canvas.getLayer('resizers');\n};\n\nResizeHandles.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'resize'\n];\n\n// helpers //////////\n\nfunction getHandleOffset(direction) {\n  var offset = {\n    x: 0,\n    y: 0\n  };\n\n  if (direction.indexOf('e') !== -1) {\n    offset.x = -HANDLE_OFFSET;\n  } else if (direction.indexOf('w') !== -1) {\n    offset.x = HANDLE_OFFSET;\n  }\n\n  if (direction.indexOf('s') !== -1) {\n    offset.y = -HANDLE_OFFSET;\n  } else if (direction.indexOf('n') !== -1) {\n    offset.y = HANDLE_OFFSET;\n  }\n\n  return offset;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}