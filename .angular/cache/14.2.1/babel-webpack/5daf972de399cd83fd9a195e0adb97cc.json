{"ast":null,"code":"import { forEach } from 'min-dash';\nimport { is } from '../../../util/ModelUtil';\nimport { isExpanded } from '../../../util/DiUtil';\nimport { GROUP_MIN_DIMENSIONS, LANE_MIN_DIMENSIONS, PARTICIPANT_MIN_DIMENSIONS, SUB_PROCESS_MIN_DIMENSIONS, TEXT_ANNOTATION_MIN_DIMENSIONS } from './ResizeBehavior';\nimport { getChildLanes } from '../util/LaneUtil';\nvar max = Math.max;\nexport default function SpaceToolBehavior(eventBus) {\n  eventBus.on('spaceTool.getMinDimensions', function (context) {\n    var shapes = context.shapes,\n        axis = context.axis,\n        start = context.start,\n        minDimensions = {};\n    forEach(shapes, function (shape) {\n      var id = shape.id;\n\n      if (is(shape, 'bpmn:Participant')) {\n        if (isHorizontal(axis)) {\n          minDimensions[id] = PARTICIPANT_MIN_DIMENSIONS;\n        } else {\n          minDimensions[id] = {\n            width: PARTICIPANT_MIN_DIMENSIONS.width,\n            height: getParticipantMinHeight(shape, start)\n          };\n        }\n      }\n\n      if (is(shape, 'bpmn:SubProcess') && isExpanded(shape)) {\n        minDimensions[id] = SUB_PROCESS_MIN_DIMENSIONS;\n      }\n\n      if (is(shape, 'bpmn:TextAnnotation')) {\n        minDimensions[id] = TEXT_ANNOTATION_MIN_DIMENSIONS;\n      }\n\n      if (is(shape, 'bpmn:Group')) {\n        minDimensions[id] = GROUP_MIN_DIMENSIONS;\n      }\n    });\n    return minDimensions;\n  });\n}\nSpaceToolBehavior.$inject = ['eventBus']; // helpers //////////\n\nfunction isHorizontal(axis) {\n  return axis === 'x';\n}\n/**\r\n * Get minimum height for participant taking lanes into account.\r\n *\r\n * @param {<djs.model.Shape>} participant\r\n * @param {number} start\r\n *\r\n * @returns {Object}\r\n */\n\n\nfunction getParticipantMinHeight(participant, start) {\n  var lanesMinHeight;\n\n  if (!hasChildLanes(participant)) {\n    return PARTICIPANT_MIN_DIMENSIONS.height;\n  }\n\n  lanesMinHeight = getLanesMinHeight(participant, start);\n  return max(PARTICIPANT_MIN_DIMENSIONS.height, lanesMinHeight);\n}\n\nfunction hasChildLanes(element) {\n  return !!getChildLanes(element).length;\n}\n\nfunction getLanesMinHeight(participant, resizeStart) {\n  var lanes = getChildLanes(participant),\n      resizedLane; // find the nested lane which is currently resized\n\n  resizedLane = findResizedLane(lanes, resizeStart); // resized lane cannot shrink below the minimum height\n  // but remaining lanes' dimensions are kept intact\n\n  return participant.height - resizedLane.height + LANE_MIN_DIMENSIONS.height;\n}\n/**\r\n * Find nested lane which is currently resized.\r\n *\r\n * @param {Array<djs.model.Shape>} lanes\r\n * @param {number} resizeStart\r\n */\n\n\nfunction findResizedLane(lanes, resizeStart) {\n  var i, lane, childLanes;\n\n  for (i = 0; i < lanes.length; i++) {\n    lane = lanes[i]; // resizing current lane or a lane nested\n\n    if (resizeStart >= lane.y && resizeStart <= lane.y + lane.height) {\n      childLanes = getChildLanes(lane); // a nested lane is resized\n\n      if (childLanes.length) {\n        return findResizedLane(childLanes, resizeStart);\n      } // current lane is the resized one\n\n\n      return lane;\n    }\n  }\n}","map":{"version":3,"names":["forEach","is","isExpanded","GROUP_MIN_DIMENSIONS","LANE_MIN_DIMENSIONS","PARTICIPANT_MIN_DIMENSIONS","SUB_PROCESS_MIN_DIMENSIONS","TEXT_ANNOTATION_MIN_DIMENSIONS","getChildLanes","max","Math","SpaceToolBehavior","eventBus","on","context","shapes","axis","start","minDimensions","shape","id","isHorizontal","width","height","getParticipantMinHeight","$inject","participant","lanesMinHeight","hasChildLanes","getLanesMinHeight","element","length","resizeStart","lanes","resizedLane","findResizedLane","i","lane","childLanes","y"],"sources":["E:/Old_PC/Study/Angular/test-bpm/node_modules/bpmn-js/lib/features/modeling/behavior/SpaceToolBehavior.js"],"sourcesContent":["import { forEach } from 'min-dash';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isExpanded } from '../../../util/DiUtil';\r\n\r\nimport {\r\n  GROUP_MIN_DIMENSIONS,\r\n  LANE_MIN_DIMENSIONS,\r\n  PARTICIPANT_MIN_DIMENSIONS,\r\n  SUB_PROCESS_MIN_DIMENSIONS,\r\n  TEXT_ANNOTATION_MIN_DIMENSIONS\r\n} from './ResizeBehavior';\r\n\r\nimport { getChildLanes } from '../util/LaneUtil';\r\n\r\nvar max = Math.max;\r\n\r\n\r\nexport default function SpaceToolBehavior(eventBus) {\r\n  eventBus.on('spaceTool.getMinDimensions', function(context) {\r\n    var shapes = context.shapes,\r\n        axis = context.axis,\r\n        start = context.start,\r\n        minDimensions = {};\r\n\r\n    forEach(shapes, function(shape) {\r\n      var id = shape.id;\r\n\r\n      if (is(shape, 'bpmn:Participant')) {\r\n\r\n        if (isHorizontal(axis)) {\r\n          minDimensions[ id ] = PARTICIPANT_MIN_DIMENSIONS;\r\n        } else {\r\n          minDimensions[ id ] = {\r\n            width: PARTICIPANT_MIN_DIMENSIONS.width,\r\n            height: getParticipantMinHeight(shape, start)\r\n          };\r\n        }\r\n\r\n      }\r\n\r\n      if (is(shape, 'bpmn:SubProcess') && isExpanded(shape)) {\r\n        minDimensions[ id ] = SUB_PROCESS_MIN_DIMENSIONS;\r\n      }\r\n\r\n      if (is(shape, 'bpmn:TextAnnotation')) {\r\n        minDimensions[ id ] = TEXT_ANNOTATION_MIN_DIMENSIONS;\r\n      }\r\n\r\n      if (is(shape, 'bpmn:Group')) {\r\n        minDimensions[ id ] = GROUP_MIN_DIMENSIONS;\r\n      }\r\n    });\r\n\r\n    return minDimensions;\r\n  });\r\n}\r\n\r\nSpaceToolBehavior.$inject = [ 'eventBus' ];\r\n\r\n\r\n// helpers //////////\r\nfunction isHorizontal(axis) {\r\n  return axis === 'x';\r\n}\r\n\r\n/**\r\n * Get minimum height for participant taking lanes into account.\r\n *\r\n * @param {<djs.model.Shape>} participant\r\n * @param {number} start\r\n *\r\n * @returns {Object}\r\n */\r\nfunction getParticipantMinHeight(participant, start) {\r\n  var lanesMinHeight;\r\n\r\n  if (!hasChildLanes(participant)) {\r\n    return PARTICIPANT_MIN_DIMENSIONS.height;\r\n  }\r\n\r\n  lanesMinHeight = getLanesMinHeight(participant, start);\r\n\r\n  return max(PARTICIPANT_MIN_DIMENSIONS.height, lanesMinHeight);\r\n}\r\n\r\nfunction hasChildLanes(element) {\r\n  return !!getChildLanes(element).length;\r\n}\r\n\r\nfunction getLanesMinHeight(participant, resizeStart) {\r\n  var lanes = getChildLanes(participant),\r\n      resizedLane;\r\n\r\n  // find the nested lane which is currently resized\r\n  resizedLane = findResizedLane(lanes, resizeStart);\r\n\r\n  // resized lane cannot shrink below the minimum height\r\n  // but remaining lanes' dimensions are kept intact\r\n  return participant.height - resizedLane.height + LANE_MIN_DIMENSIONS.height;\r\n}\r\n\r\n/**\r\n * Find nested lane which is currently resized.\r\n *\r\n * @param {Array<djs.model.Shape>} lanes\r\n * @param {number} resizeStart\r\n */\r\nfunction findResizedLane(lanes, resizeStart) {\r\n  var i, lane, childLanes;\r\n\r\n  for (i = 0; i < lanes.length; i++) {\r\n    lane = lanes[i];\r\n\r\n    // resizing current lane or a lane nested\r\n    if (resizeStart >= lane.y && resizeStart <= lane.y + lane.height) {\r\n      childLanes = getChildLanes(lane);\r\n\r\n      // a nested lane is resized\r\n      if (childLanes.length) {\r\n        return findResizedLane(childLanes, resizeStart);\r\n      }\r\n\r\n      // current lane is the resized one\r\n      return lane;\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}